<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>​‌‍​‌‍​‌‍</title>
    <meta name="description" content="Персональный трекер статистики игроков">
    
    <!-- Cache busting -->
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    
    <!-- Disable context menu and selections -->
    <meta name="msapplication-tap-highlight" content="no">
    <meta name="format-detection" content="telephone=no">
    <meta name="apple-touch-fullscreen" content="yes">
    
    <!-- Полноэкранный режим - отключение всех системных элементов -->
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="format-detection" content="telephone=no">
    <meta name="msapplication-tap-highlight" content="no">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, minimal-ui, viewport-fit=cover">
    
    <!-- PWA Theme Colors - для интеграции с системой Windows -->
    <meta name="theme-color" content="#0d1117" media="(prefers-color-scheme: dark)">
    <meta name="theme-color" content="#161b22" media="(prefers-color-scheme: light)">
    <meta name="theme-color" content="#0d1117">
    
    <!-- PWA Meta Tags -->
    <link rel="manifest" href="manifest.json">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="​‌‍">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="application-name" content="​‌‍">
    
    <!-- Windows PWA Integration -->
    <meta name="msapplication-TileColor" content="#0d1117">
    <meta name="msapplication-navbutton-color" content="#0d1117">
    <meta name="msapplication-starturl" content="/">
    <meta name="msapplication-config" content="/browserconfig.xml">
    
    <!-- Icons -->
    <link rel="icon" type="image/png" sizes="192x192" href="icons/icon-192x192.png">
    <link rel="apple-touch-icon" href="icons/icon-192x192.png">
    
    <!-- Styles -->
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="community-styles.css">
    
    <!-- html2canvas for screenshots -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
</head>
<body>
    <!-- PWA Directory Check Script -->
    <script>
        (function() {
            // Принудительное скрытие titlebar и системных элементов
            function hideTitlebar() {
                // Убираем отступы у body
                document.body.style.margin = '0';
                document.body.style.padding = '0';
                document.body.style.border = 'none';
                document.body.style.outline = 'none';
                
                // Убираем отступы у html
                document.documentElement.style.margin = '0';
                document.documentElement.style.padding = '0';
                document.documentElement.style.border = 'none';
                
                // Принудительно скрываем titlebar-drag-region
                const titlebar = document.querySelector('.titlebar-drag-region');
                if (titlebar) {
                    titlebar.style.display = 'none';
                    titlebar.style.visibility = 'hidden';
                    titlebar.style.height = '0';
                    titlebar.style.opacity = '0';
                    titlebar.remove();
                }
                
                // Убираем все возможные отступы у app-container
                const appContainer = document.querySelector('.app-container');
                if (appContainer) {
                    appContainer.style.marginTop = '0';
                    appContainer.style.paddingTop = '0';
                    appContainer.style.borderTop = 'none';
                }
            }
            
            // Вызываем немедленно
            hideTitlebar();
            
            // Вызываем после загрузки
            document.addEventListener('DOMContentLoaded', hideTitlebar);
            
            // Вызываем при изменении размера окна
            window.addEventListener('resize', hideTitlebar);
            
            // Проверяем, показывается ли directory listing
            const isDirectoryListing = document.title.includes('listing directory') || 
                                     document.title.includes('Index of') ||
                                     window.location.pathname.endsWith('/') && 
                                     !window.location.pathname.includes('index.html');
            
            // Если это directory listing в PWA, перенаправляем
            if (isDirectoryListing && window.matchMedia('(display-mode: standalone)').matches) {
                window.location.replace(window.location.href + 'index.html');
                return;
            }
            
            // Проверяем, что приложение загрузилось корректно (ТОЛЬКО ОДИН РАЗ)
            let reloadAttempted = sessionStorage.getItem('reloadAttempted');
            
            setTimeout(() => {
                const appContainer = document.querySelector('.app-container');
                const hasScript = document.querySelector('script[src="app-optimized.js"]');
                
                // Проверяем только если действительно что-то не так
                if (!appContainer && window.matchMedia('(display-mode: standalone)').matches && !reloadAttempted && !hasScript) {
                    sessionStorage.setItem('reloadAttempted', 'true');
                    
                    const currentPath = window.location.pathname;
                    if (!currentPath.includes('index.html')) {
                        console.log('PWA: Redirecting to index.html (first attempt)');
                        window.location.replace(window.location.origin + currentPath + 'index.html');
                    }
                } else if (reloadAttempted && !appContainer && !hasScript) {
                    // Если уже пытались перезагрузить, просто показываем сообщение
                    console.log('PWA: App failed to load after reload attempt');
                    document.body.innerHTML = '<div style="color: white; text-align: center; padding: 50px;">Ошибка загрузки приложения. Обновите страницу.</div>';
                }
            }, 5000); // Увеличиваем время ожидания до 5 секунд
        })();
    </script>
    
    <!-- Drag region for window controls overlay (СКРЫТО) -->
    <div class="titlebar-drag-region" id="titlebar-drag-region" style="display: none !important;"></div>
    
    <div class="app-container">
        <!-- Side Navigation -->
        <nav class="glass-nav sidebar">
            <div class="nav-content">
                <div class="nav-item active" data-tab="home" title="Главная">
                    <svg viewBox="0 0 24 24" class="nav-icon">
                        <path d="M12 2L2 7v10c0 5.55 3.84 10 9 11 1.16.21 2.34.21 3.5 0 5.16-1 9-5.45 9-11V7l-10-5z"/>
                    </svg>
                    <span>Главная</span>
                </div>
                <div class="nav-item" data-tab="players" title="Игроки">
                    <svg viewBox="0 0 24 24" class="nav-icon">
                        <path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"/>
                    </svg>
                    <span>Игроки</span>
                </div>
                <div class="nav-item" data-tab="stats" title="Статистика">
                    <svg viewBox="0 0 24 24" class="nav-icon">
                        <path d="M3.5 18.49l6-6.01 4 4L22 6.92l-1.41-1.41-7.09 7.97-4-4L2 16.99z"/>
                    </svg>
                    <span>Статистика</span>
                </div>
                <!-- ВРЕМЕННО СКРЫТА кнопка Сообщество -->
                <div class="nav-item" data-tab="community" title="Сообщество" style="display: none !important;">
                    <svg viewBox="0 0 24 24" class="nav-icon">
                        <path d="M12,5.5A3.5,3.5 0 0,1 15.5,9A3.5,3.5 0 0,1 12,12.5A3.5,3.5 0 0,1 8.5,9A3.5,3.5 0 0,1 12,5.5M5,8C5.56,8 6.08,8.15 6.53,8.42C6.38,9.85 6.8,11.27 7.66,12.38C7.16,13.34 6.16,14 5,14A3,3 0 0,1 2,11A3,3 0 0,1 5,8M19,8A3,3 0 0,1 22,11A3,3 0 0,1 19,14C17.84,14 16.84,13.34 16.34,12.38C17.2,11.27 17.62,9.85 17.47,8.42C17.92,8.15 18.44,8 19,8M5.5,18.25C5.5,16.18 8.41,14.5 12,14.5C15.59,14.5 18.5,16.18 18.5,18.25V20H5.5V18.25M0,20V18.5C0,17.11 1.89,15.94 4.45,15.6C3.86,16.28 3.5,17.22 3.5,18.25V20H0M24,20H20.5V18.25C20.5,17.22 20.14,16.28 19.55,15.6C22.11,15.94 24,17.11 24,18.5V20Z"/>
                    </svg>
                    <span>Сообщество</span>
                </div>
                <div class="nav-item" data-tab="settings" title="Настройки">
                    <svg viewBox="0 0 24 24" class="nav-icon">
                        <path d="M19.14,12.94c0.04-0.3,0.06-0.61,0.06-0.94c0-0.32-0.02-0.64-0.07-0.94l2.03-1.58c0.18-0.14,0.23-0.41,0.12-0.61 l-1.92-3.32c-0.12-0.22-0.37-0.29-0.59-0.22l-2.39,0.96c-0.5-0.38-1.03-0.7-1.62-0.94L14.4,2.81c-0.04-0.24-0.24-0.41-0.48-0.41 h-3.84c-0.24,0-0.43,0.17-0.47,0.41L9.25,5.35C8.66,5.59,8.12,5.92,7.63,6.29L5.24,5.33c-0.22-0.08-0.47,0-0.59,0.22L2.74,8.87 C2.62,9.08,2.66,9.34,2.86,9.48l2.03,1.58C4.84,11.36,4.82,11.69,4.82,12s0.02,0.64,0.07,0.94l-2.03,1.58 c-0.18,0.14-0.23,0.41-0.12,0.61l1.92,3.32c0.12,0.22,0.37,0.29,0.59,0.22l2.39-0.96c0.5,0.38,1.03,0.7,1.62,0.94l0.36,2.54 c0.05,0.24,0.24,0.41,0.48,0.41h3.84c0.24,0,0.44-0.17,0.47-0.41l0.36-2.54c0.59-0.24,1.13-0.56,1.62-0.94l2.39,0.96 c0.22,0.08,0.47,0,0.59-0.22l1.92-3.32c0.12-0.22,0.07-0.47-0.12-0.61L19.14,12.94z M12,15.6c-1.98,0-3.6-1.62-3.6-3.6 s1.62-3.6,3.6-3.6s3.6,1.62,3.6,3.6S13.98,15.6,12,15.6z"/>
                    </svg>
                    <span>Настройки</span>
                </div>
            </div>
        </nav>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Home Tab -->
            <div class="tab-content active" id="home">
                <div class="glass-card welcome-card">
                    <h1 class="welcome-title">Персональные заметки</h1>
                    <p class="welcome-subtitle">Ведите учёт статистики и достижений</p>
                    
                    <!-- Quick Add Player -->
                    <div class="quick-add-section">
                        <div class="quick-add-form">
                            <input type="text" id="quick-nickname" class="glass-input" placeholder="Поиск или добавить никнейм">
                            <button class="glass-button primary" id="quick-add-btn">
                                <svg viewBox="0 0 24 24" class="button-icon">
                                    <path d="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"/>
                                </svg>
                                Добавить
                            </button>
                        </div>
                    </div>
                    
                    <div class="stats-overview">
                        <div class="stat-item">
                            <div class="stat-number" id="total-players">0</div>
                            <div class="stat-label">Игроков</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-number" id="total-kills">0</div>
                            <div class="stat-label">Убийств</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-number" id="total-deaths">0</div>
                            <div class="stat-label">Смертей</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-number" id="total-time">0</div>
                            <div class="stat-label">Часов</div>
                        </div>
                    </div>
                    
                    <!-- Дополнительный контент для заполнения пространства -->
                    <div class="home-additional-content">
                        <!-- Последние действия -->
                        <div class="glass-card recent-actions-card">
                            <h3>📈 Последние действия</h3>
                            <div class="recent-actions-list" id="recent-actions-list">
                                <div class="recent-action-item">
                                    <div class="action-icon">👤</div>
                                    <div class="action-text">
                                        <div class="action-title">Добро пожаловать!</div>
                                        <div class="action-subtitle">Начните добавлять игроков</div>
                                    </div>
                                    <div class="action-time">сейчас</div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Быстрые действия -->
                        <div class="glass-card quick-actions-card">
                            <h3>⚡ Быстрые действия</h3>
                            <div class="quick-actions-grid">
                                <button class="quick-action-btn" onclick="appNew.openPlayerModal()">
                                    <svg viewBox="0 0 24 24" class="quick-action-icon">
                                        <path d="M15,14C12.33,14 7,15.33 7,18V20H23V18C23,15.33 17.67,14 15,14M6,10V7H4V10H1V12H4V15H6V12H9V10M15,12A4,4 0 0,0 19,8A4,4 0 0,0 15,4A4,4 0 0,0 11,8A4,4 0 0,0 15,12Z"/>
                                    </svg>
                                    <span>Добавить игрока</span>
                                </button>
                                <button class="quick-action-btn" onclick="appNew.switchTab('stats')">
                                    <svg viewBox="0 0 24 24" class="quick-action-icon">
                                        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
                                    </svg>
                                    <span>Статистика</span>
                                </button>
                                <button class="quick-action-btn" onclick="appNew.switchTab('players')">
                                    <svg viewBox="0 0 24 24" class="quick-action-icon">
                                        <path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"/>
                                    </svg>
                                    <span>Все игроки</span>
                                </button>
                                <button class="quick-action-btn" onclick="appNew.switchTab('settings')">
                                    <svg viewBox="0 0 24 24" class="quick-action-icon">
                                        <path d="M19.14,12.94c0.04-0.3,0.06-0.61,0.06-0.94c0-0.32-0.02-0.64-0.07-0.94l2.03-1.58c0.18-0.14,0.23-0.41,0.12-0.61 l-1.92-3.32c-0.12-0.22-0.37-0.29-0.59-0.22l-2.39,0.96c-0.5-0.38-1.03-0.7-1.62-0.94L14.4,2.81c-0.04-0.24-0.24-0.41-0.48-0.41 h-3.84c-0.24,0-0.43,0.17-0.47,0.41L9.25,5.35C8.66,5.59,8.12,5.92,7.63,6.29L5.24,5.33c-0.22-0.08-0.47,0-0.59,0.22L2.74,8.87 C2.62,9.08,2.66,9.34,2.86,9.48l2.03,1.58C4.84,11.36,4.82,11.69,4.82,12s0.02,0.64,0.07,0.94l-2.03,1.58 c-0.18,0.14-0.23,0.41-0.12,0.61l1.92,3.32c0.12,0.22,0.37,0.29,0.59,0.22l2.39-0.96c0.5,0.38,1.03,0.7,1.62,0.94l0.36,2.54 c0.05,0.24,0.24,0.41,0.48,0.41h3.84c0.24,0,0.44-0.17,0.47-0.41l0.36-2.54c0.59-0.24,1.13-0.56,1.62-0.94l2.39,0.96 c0.22,0.08,0.47,0,0.59-0.22l1.92-3.32c0.12-0.22,0.07-0.47-0.12-0.61L19.14,12.94z M12,15.6c-1.98,0-3.6-1.62-3.6-3.6 s1.62-3.6,3.6-3.6s3.6,1.62,3.6,3.6S13.98,15.6,12,15.6z"/>
                                    </svg>
                                    <span>Настройки</span>
                                </button>
                            </div>
                        </div>
                        
                        <!-- Топ игроки (мини) -->
                        <div class="glass-card top-players-mini">
                            <h3>🏆 Топ игроки</h3>
                            <div class="top-players-mini-list" id="top-players-mini-list">
                                <div class="empty-state">
                                    <div class="empty-icon">👥</div>
                                    <p>Пока нет игроков</p>
                                    <p class="empty-hint">Добавьте первого игрока чтобы увидеть статистику</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Players Tab -->
            <div class="tab-content" id="players">
                <!-- Players Header -->
                <div class="players-page-header">
                    <h1><svg style="width:24px;height:24px;fill:currentColor;vertical-align:middle;" viewBox="0 0 24 24"><path d="M16 4c0-1.11.89-2 2-2s2 .89 2 2-.89 2-2 2-2-.89-2-2zm4 18v-6h2.5l-2.54-7.63c-.34-1.02-1.3-1.73-2.39-1.73H13.5c-.87 0-1.66.46-2.1 1.2l-2.75 4.61c-.16.26-.25.55-.25.85 0 .83.67 1.5 1.5 1.5.22 0 .42-.05.6-.14L12.5 12H15v10h1zm-12.5-11c.83 0 1.5-.67 1.5-1.5S8.33 9 7.5 9 6 9.67 6 11s.67 1.5 1.5 1.5zm1.5 1h-3C5.01 12 4 13.01 4 14.5V16h8v-1.5C12 13.01 10.99 12 9.5 12z"/></svg> Игроки</h1>
                    <button class="glass-button primary" id="add-player-btn">
                        <svg viewBox="0 0 24 24" class="button-icon">
                            <path d="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"/>
                        </svg>
                        Добавить игрока
                    </button>
                </div>

                <!-- Filter Buttons -->
                <div class="players-filter-section">
                    <div class="players-filter-buttons">
                        <button class="players-filter-btn active" data-sort="name">По имени</button>
                        <button class="players-filter-btn" data-sort="kills">По убийствам</button>
                        <button class="players-filter-btn" data-sort="deaths">По смертям</button>
                        <button class="players-filter-btn" data-sort="time">По времени</button>
                        <button class="players-filter-btn" data-sort="date">По дате</button>
                    </div>
                </div>

                <!-- Players Grid -->
                <div class="players-cards-grid" id="players-cards-grid">
                    <!-- Player cards will be populated here -->
                </div>
            </div>

            <!-- Stats Tab -->
            <div class="tab-content" id="stats">
                <!-- Stats Header -->
                <div class="stats-page-header">
                    <h1><svg style="width:24px;height:24px;fill:currentColor;vertical-align:middle;" viewBox="0 0 24 24"><path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/></svg> Статистика игроков</h1>
                    <p>Анализ эффективности и прогресса</p>
                </div>

                <!-- Main Stats Layout -->
                <div class="stats-main-layout">
                    <!-- Left Column: Top-5 and Filter Buttons -->
                    <div class="stats-left-column">
                        <!-- Filter Buttons -->
                        <div class="stats-filter-buttons">
                            <button class="filter-btn active" data-filter="kills">Убийства</button>
                            <button class="filter-btn" data-filter="deaths">Смерти</button>
                            <button class="filter-btn" data-filter="time">Время</button>
                            <button class="filter-btn" data-filter="kd">K/D</button>
                        </div>

                        <!-- Top-5 Players -->
                        <div class="top-5-section">
                            <h2><svg style="width:20px;height:20px;fill:currentColor;vertical-align:middle;" viewBox="0 0 24 24"><path d="M5 16L3 5l5.5-1L12 8l3.5-4L21 5l-2 11H5zm2.7-2h8.6l.9-5.4-2.1-.4L12 12l-3.1-3.8-2.1.4L7.7 14z"/></svg> Топ-5 игроков</h2>
                            <div class="top-5-list" id="top-5-list">
                                <!-- Top 5 players will be populated here -->
                            </div>
                        </div>
                    </div>

                    <!-- Right Column: Player Cards -->
                    <div class="stats-right-column">
                        <h2><svg style="width:20px;height:20px;fill:currentColor;vertical-align:middle;" viewBox="0 0 24 24"><path d="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"/></svg> Игрок Убийства</h2>
                        <div class="featured-players-grid" id="featured-players-grid">
                            <!-- Featured player cards will be populated here -->
                        </div>
                    </div>
                </div>

                <!-- Overall Stats -->
                <div class="overall-stats-section">
                    <h2>Общая статистика</h2>
                    <div class="overall-stats-grid">
                        <div class="overall-stat-card">
                            <div class="stat-number" id="total-players-stat">0</div>
                            <div class="stat-label">ИГРОКОВ</div>
                        </div>
                        <div class="overall-stat-card">
                            <div class="stat-number" id="total-kills-stat">0</div>
                            <div class="stat-label">УБИЙСТВ</div>
                        </div>
                        <div class="overall-stat-card">
                            <div class="stat-number" id="total-deaths-stat">0</div>
                            <div class="stat-label">СМЕРТЕЙ</div>
                        </div>
                        <div class="overall-stat-card">
                            <div class="stat-number" id="total-time-stat">0</div>
                            <div class="stat-label">ВРЕМЕНИ</div>
                        </div>
                        <div class="overall-stat-card">
                            <div class="stat-number" id="total-time-stat">0</div>
                            <div class="stat-label">ВРЕМЕНИ</div>
                        </div>
                    </div>
                </div>

                <!-- Detailed Stats Modal -->
                <div class="detailed-stats-overlay" id="detailed-stats-modal" style="display: none;">
                    <div class="detailed-stats-modal glass-card">
                        <div class="modal-header">
                            <h3 id="detailed-player-name">Детальная статистика</h3>
                            <button class="close-button" id="close-detailed-stats">
                                <svg viewBox="0 0 24 24">
                                    <path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/>
                                </svg>
                            </button>
                        </div>
                        <div id="detailed-stats-content" class="detailed-stats-content">
                            <!-- Detailed stats content will be populated here -->
                        </div>
                    </div>
                </div>
            </div>

            <!-- Community Tab -->
            <div class="tab-content" id="community">
                <!-- Community Full-Screen Interface -->
                <div class="community-fullscreen-header">
                    <button class="community-back-button" id="community-back-btn">
                        <svg viewBox="0 0 24 24">
                            <path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z"/>
                        </svg>
                    </button>
                    <h1 class="community-header-title">Сообщество игроков</h1>
                    <div class="community-header-actions">
                        <button class="community-back-button" id="community-search-btn" title="Поиск">
                            <svg viewBox="0 0 24 24">
                                <path d="M9.5,3A6.5,6.5 0 0,1 16,9.5C16,11.11 15.41,12.59 14.44,13.73L14.71,14H15.5L20.5,19L19,20.5L14,15.5V14.71L13.73,14.44C12.59,15.41 11.11,16 9.5,16A6.5,6.5 0 0,1 3,9.5A6.5,6.5 0 0,1 9.5,3M9.5,5C7,5 5,7 5,9.5C5,12 7,14 9.5,14C12,14 14,12 14,9.5C14,7 12,5 9.5,5Z"/>
                            </svg>
                        </button>
                        <button class="community-back-button" id="community-settings-btn" title="Настройки">
                            <svg viewBox="0 0 24 24">
                                <path d="M12,15.5A3.5,3.5 0 0,1 8.5,12A3.5,3.5 0 0,1 12,8.5A3.5,3.5 0 0,1 15.5,12A3.5,3.5 0 0,1 12,15.5M19.43,12.97C19.47,12.65 19.5,12.33 19.5,12C19.5,11.67 19.47,11.35 19.43,11.03L21.54,9.37C21.73,9.22 21.78,8.95 21.66,8.73L19.66,5.27C19.54,5.05 19.27,4.96 19.05,5.05L16.56,6.05C16.04,5.66 15.5,5.32 14.87,5.07L14.5,2.42C14.46,2.18 14.25,2 14,2H10C9.75,2 9.54,2.18 9.5,2.42L9.13,5.07C8.5,5.32 7.96,5.66 7.44,6.05L4.95,5.05C4.73,4.96 4.46,5.05 4.34,5.27L2.34,8.73C2.22,8.95 2.27,9.22 2.46,9.37L4.57,11.03C4.53,11.35 4.5,11.67 4.5,12C4.5,12.33 4.53,12.65 4.57,12.97L2.46,14.63C2.27,14.78 2.22,15.05 2.34,15.27L4.34,18.73C4.46,18.95 4.73,19.03 4.95,18.95L7.44,17.94C7.96,18.34 8.5,18.68 9.13,18.93L9.5,21.58C9.54,21.82 9.75,22 10,22H14C14.25,22 14.46,21.82 14.5,21.58L14.87,18.93C15.5,18.68 16.04,18.34 16.56,17.94L19.05,18.95C19.27,19.03 19.54,18.95 19.66,18.73L21.66,15.27C21.78,15.05 21.73,14.78 21.54,14.63L19.43,12.97Z"/>
                            </svg>
                        </button>
                    </div>
                </div>

                <div class="community-fullscreen-content">
                    <!-- Animated tabs -->
                    <div class="community-tabs">
                        <button class="community-tab active" data-community-tab="chat">
                            <svg style="width:16px;height:16px;margin-right:8px;" viewBox="0 0 24 24">
                                <path d="M12,3C6.5,3 2,6.58 2,11C2.05,13.15 3.06,15.17 4.75,16.5C4.75,17.1 4.33,18.67 2,21C4.37,20.89 6.64,20 8.47,18.5C9.61,18.83 10.81,19 12,19C17.5,19 22,15.42 22,11C22,6.58 17.5,3 12,3M12,17C7.58,17 4,14.31 4,11C4,7.69 7.58,5 12,5C16.42,5 20,7.69 20,11C20,14.31 16.42,17 12,17Z"/>
                            </svg>
                            Чат
                        </button>
                        <button class="community-tab" data-community-tab="activity">
                            <svg style="width:16px;height:16px;margin-right:8px;" viewBox="0 0 24 24">
                                <path d="M12,2A10,10 0 0,1 22,12A10,10 0 0,1 12,22A10,10 0 0,1 2,12A10,10 0 0,1 12,2M12,4A8,8 0 0,0 4,12A8,8 0 0,0 12,20A8,8 0 0,0 20,12A8,8 0 0,0 12,4M11,17H13V11H11V17M11,9H13V7H11V9Z"/>
                            </svg>
                            Активность
                        </button>
                        <button class="community-tab" data-community-tab="leaderboard">
                            <svg style="width:16px;height:16px;margin-right:8px;" viewBox="0 0 24 24">
                                <path d="M5,16L3,14L5,12L6.5,13.5L11,9L16.5,14.5L22,9L23,10L16.5,16.5L11,11L7.5,14.5L5,16M15.5,2L16.5,8H23V10H8V8H14.5L13.5,2H15.5Z"/>
                            </svg>
                            Рейтинг
                        </button>
                        <button class="community-tab" data-community-tab="tournaments">
                            <svg style="width:16px;height:16px;margin-right:8px;" viewBox="0 0 24 24">
                                <path d="M12 2L13.09 8.26L22 9L13.09 9.74L12 16L10.91 9.74L2 9L10.91 8.26L12 2M7 22L7.81 18.81L11 18L7.81 17.19L7 14L6.19 17.19L3 18L6.19 18.81L7 22M17 22L17.81 18.81L21 18L17.81 17.19L17 14L16.19 17.19L13 18L16.19 18.81L17 22"/>
                            </svg>
                            Турниры
                        </button>
                    </div>

                    <!-- Chat Tab Content -->
                    <div class="community-tab-content active" id="community-chat-content">
                        <!-- Простой обычный чат -->
                        <div style="padding: 20px; background: rgba(255,255,255,0.1); margin: 16px; border-radius: 12px;">
                            <h3 style="color: white; margin-bottom: 20px;">💬 Общий чат</h3>
                            
                            <!-- Сообщения -->
                            <div id="simple-messages" style="background: rgba(0,0,0,0.3); padding: 15px; border-radius: 8px; margin-bottom: 20px; min-height: 300px; max-height: 400px; overflow-y: auto;">
                                <div style="color: #ccc; margin-bottom: 15px; padding: 10px; background: rgba(255,255,255,0.1); border-radius: 6px;">
                                    <strong style="color: #4CAF50;">🤖 Система:</strong> Добро пожаловать в чат игроков!
                                </div>
                                <div style="color: #ccc; margin-bottom: 15px; padding: 10px; background: rgba(255,255,255,0.05); border-radius: 6px;">
                                    <strong style="color: #2196F3;">🎮 Игрок123:</strong> Привет всем! Кто хочет играть в команде?
                                </div>
                                <div style="color: #ccc; margin-bottom: 15px; padding: 10px; background: rgba(255,255,255,0.05); border-radius: 6px;">
                                    <strong style="color: #FF9800;">🏆 ПроГеймер:</strong> Я готов! Начинаем новый турнир?
                                </div>
                                <div style="color: #ccc; margin-bottom: 15px; padding: 10px; background: rgba(255,255,255,0.05); border-radius: 6px;">
                                    <strong style="color: #9C27B0;">⚡ БыстрыйСтрелок:</strong> Присоединяюсь! Мой рекорд 47 убийств 🔥
                                </div>
                            </div>
                            
                            <!-- Поле ввода -->
                            <div style="display: flex; gap: 10px; align-items: stretch;">
                                <input 
                                    type="text" 
                                    placeholder="Напишите сообщение..." 
                                    style="flex: 1; padding: 12px; background: rgba(255,255,255,0.1); border: 1px solid rgba(255,255,255,0.3); border-radius: 6px; color: white; font-size: 14px;"
                                    id="simple-chat-input"
                                >
                                <button 
                                    style="padding: 12px 20px; background: #4CAF50; border: none; border-radius: 6px; color: white; font-weight: bold; cursor: pointer; min-width: 80px;"
                                    onclick="sendSimpleMessage()"
                                >
                                    📤 Отправить
                                </button>
                            </div>
                            
                            <!-- Дополнительная информация -->
                            <div style="margin-top: 15px; padding: 10px; background: rgba(255,255,255,0.05); border-radius: 6px; font-size: 12px; color: #999; text-align: center;">
                                📊 Онлайн: <span style="color: #4CAF50; font-weight: bold;">24</span> игрока | 
                                💬 Сообщений сегодня: <span style="color: #2196F3; font-weight: bold;">156</span> | 
                                🏆 Активных турниров: <span style="color: #FF9800; font-weight: bold;">3</span>
                            </div>
                        </div>
                    </div>

                    <!-- Activity Tab Content -->
                    <div class="community-tab-content" id="community-activity-content">
                        <div class="community-activity-feed">
                            <div class="community-activity-item">
                                <div class="community-activity-avatar">
                                    <svg style="width:16px;height:16px;fill:white;" viewBox="0 0 24 24">
                                        <path d="M12,4A4,4 0 0,1 16,8A4,4 0 0,1 12,12A4,4 0 0,1 8,8A4,4 0 0,1 12,4M12,14C16.42,14 20,15.79 20,18V20H4V18C4,15.79 7.58,14 12,14Z"/>
                                    </svg>
                                </div>
                                <div class="community-activity-content">
                                    <div class="community-activity-text">
                                        <strong>БыстрыйИгрок123</strong> установил новый рекорд: 45 убийств за игру! 🔥
                                    </div>
                                    <div class="community-activity-time">2 минуты назад</div>
                                </div>
                            </div>

                            <div class="community-activity-item">
                                <div class="community-activity-avatar">
                                    <svg style="width:16px;height:16px;fill:white;" viewBox="0 0 24 24">
                                        <path d="M12,4A4,4 0 0,1 16,8A4,4 0 0,1 12,12A4,4 0 0,1 8,8A4,4 0 0,1 12,4M12,14C16.42,14 20,15.79 20,18V20H4V18C4,15.79 7.58,14 12,14Z"/>
                                    </svg>
                                </div>
                                <div class="community-activity-content">
                                    <div class="community-activity-text">
                                        <strong>УмныйБоец456</strong> присоединился к сообществу
                                    </div>
                                    <div class="community-activity-time">5 минут назад</div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Leaderboard Tab Content -->
                    <div class="community-tab-content" id="community-leaderboard-content">
                        <div class="community-activity-feed">
                            <h3 style="color: white; text-align: center; margin-bottom: 20px;">🏆 Топ игроков</h3>
                            
                            <div class="community-activity-item">
                                <div class="community-activity-avatar">
                                    <svg style="width:16px;height:16px;fill:white;" viewBox="0 0 24 24">
                                        <path d="M5,16L3,14L5,12L6.5,13.5L11,9L16.5,14.5L22,9L23,10L16.5,16.5L11,11L7.5,14.5L5,16M15.5,2L16.5,8H23V10H8V8H14.5L13.5,2H15.5Z"/>
                                    </svg>
                                </div>
                                <div class="community-activity-content">
                                    <div class="community-activity-text">
                                        <strong>1. КорольИгры999</strong> - 2,847 убийств
                                    </div>
                                    <div class="community-activity-time">K/D: 4.2</div>
                                </div>
                            </div>

                            <div class="community-activity-item">
                                <div class="community-activity-avatar">
                                    <svg style="width:16px;height:16px;fill:white;" viewBox="0 0 24 24">
                                        <path d="M12,4A4,4 0 0,1 16,8A4,4 0 0,1 12,12A4,4 0 0,1 8,8A4,4 0 0,1 12,4M12,14C16.42,14 20,15.79 20,18V20H4V18C4,15.79 7.58,14 12,14Z"/>
                                    </svg>
                                </div>
                                <div class="community-activity-content">
                                    <div class="community-activity-text">
                                        <strong>2. БыстрыйИгрок123</strong> - 2,156 убийств
                                    </div>
                                    <div class="community-activity-time">K/D: 3.2</div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Tournaments Tab Content -->
                    <div class="community-tab-content" id="community-tournaments-content">
                        <div class="community-activity-feed">
                            <h3 style="color: white; text-align: center; margin-bottom: 20px;">🎯 Активные турниры</h3>
                            
                            <div class="community-activity-item">
                                <div class="community-activity-avatar">
                                    <svg style="width:16px;height:16px;fill:white;" viewBox="0 0 24 24">
                                        <path d="M12 2L13.09 8.26L22 9L13.09 9.74L12 16L10.91 9.74L2 9L10.91 8.26L12 2M7 22L7.81 18.81L11 18L7.81 17.19L7 14L6.19 17.19L3 18L6.19 18.81L7 22M17 22L17.81 18.81L21 18L17.81 17.19L17 14L16.19 17.19L13 18L16.19 18.81L17 22"/>
                                    </svg>
                                </div>
                                <div class="community-activity-content">
                                    <div class="community-activity-text">
                                        <strong>Еженедельный турнир</strong><br>
                                        Соревнование на лучший K/D
                                    </div>
                                    <div class="community-activity-time">24 участника • Приз: Золотой статус</div>
                                </div>
                            </div>

                            <div class="community-activity-item">
                                <div class="community-activity-avatar">
                                    <svg style="width:16px;height:16px;fill:white;" viewBox="0 0 24 24">
                                        <path d="M12 2L13.09 8.26L22 9L13.09 9.74L12 16L10.91 9.74L2 9L10.91 8.26L12 2M7 22L7.81 18.81L11 18L7.81 17.19L7 14L6.19 17.19L3 18L6.19 18.81L7 22M17 22L17.81 18.81L21 18L17.81 17.19L17 14L16.19 17.19L13 18L16.19 18.81L17 22"/>
                                    </svg>
                                </div>
                                <div class="community-activity-content">
                                    <div class="community-activity-text">
                                        <strong>Быстрые убийства</strong><br>
                                        Кто убьет 50 врагов быстрее всех
                                    </div>
                                    <div class="community-activity-time">8 участников • Старт: через 2 дня</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>            <!-- Settings Tab -->
            <div class="tab-content" id="settings">
                <!-- Background Settings -->
                <div class="glass-card">
                    <div class="card-header">
                        <h2>Фон приложения</h2>
                    </div>
                    
                    <div class="background-options">
                        <div class="bg-option" data-bg="https://i.postimg.cc/XJkg1VB3/a-gift-for-you-bocchi-the-rock-thumb.jpg">
                            <img src="https://i.postimg.cc/XJkg1VB3/a-gift-for-you-bocchi-the-rock-thumb.jpg" alt="Bocchi the Rock">
                            <span>Bocchi the Rock</span>
                        </div>
                        <div class="bg-option" data-bg="https://i.postimg.cc/pdNMQZt8/korus-beachside-cafe-thumb.jpg">
                            <img src="https://i.postimg.cc/pdNMQZt8/korus-beachside-cafe-thumb.jpg" alt="Beach Cafe">
                            <span>Beach Cafe</span>
                        </div>
                        <div class="bg-option" data-bg="https://i.postimg.cc/YSV8Zp3m/field-of-daisies-thumb.jpg">
                            <img src="https://i.postimg.cc/YSV8Zp3m/field-of-daisies-thumb.jpg" alt="Field of Daisies">
                            <span>Поле ромашек</span>
                        </div>
                        <div class="bg-option" data-bg="https://i.postimg.cc/dVVB07Ny/luffy-clouds-one-piece-thumb.jpg">
                            <img src="https://i.postimg.cc/dVVB07Ny/luffy-clouds-one-piece-thumb.jpg" alt="Luffy One Piece">
                            <span>One Piece</span>
                        </div>
                        <div class="bg-option" data-bg="https://i.postimg.cc/g0fq4gzV/black-cat-sakura-thumb.jpg">
                            <img src="https://i.postimg.cc/g0fq4gzV/black-cat-sakura-thumb.jpg" alt="Black Cat Sakura">
                            <span>Кот сакура</span>
                        </div>
                        <div class="bg-option" data-bg="https://i.postimg.cc/Yqgg3str/fishing-adventure-time-thumb.jpg">
                            <img src="https://i.postimg.cc/Yqgg3str/fishing-adventure-time-thumb.jpg" alt="Fishing Adventure Time">
                            <span>Adventure Time Рыбалка</span>
                        </div>
                        <div class="bg-option" data-bg="https://i.postimg.cc/ZKDjjtTv/mila-looking-at-you-miside-thumb.jpg">
                            <img src="https://i.postimg.cc/ZKDjjtTv/mila-looking-at-you-miside-thumb.jpg" alt="Mila Miside">
                            <span>Mila Miside</span>
                        </div>
                        <div class="bg-option" data-bg="https://i.postimg.cc/sXN1qc1m/gojo-cursed-technique-lapse-blue-jujutsu-kaisen-thumb.jpg">
                            <img src="https://i.postimg.cc/sXN1qc1m/gojo-cursed-technique-lapse-blue-jujutsu-kaisen-thumb.jpg" alt="Gojo Jujutsu Kaisen">
                            <span>Gojo Jujutsu Kaisen</span>
                        </div>
                        <div class="bg-option" data-bg="https://i.postimg.cc/0jN5kJKQ/lofi-pink-town-thumb.jpg">
                            <img src="https://i.postimg.cc/0jN5kJKQ/lofi-pink-town-thumb.jpg" alt="Lofi Pink Town">
                            <span>Lofi Pink Town</span>
                        </div>
                        <div class="bg-option" data-bg="https://i.postimg.cc/mkcxp3FQ/abandoned-house-lake-thumb.jpg">
                            <img src="https://i.postimg.cc/mkcxp3FQ/abandoned-house-lake-thumb.jpg" alt="Abandoned House Lake">
                            <span>Заброшенный дом у озера</span>
                        </div>
                        <div class="bg-option" data-bg="https://i.postimg.cc/zDWLyc7N/moonlight-drive-thumb.jpg">
                            <img src="https://i.postimg.cc/zDWLyc7N/moonlight-drive-thumb.jpg" alt="Moonlight Drive">
                            <span>Moonlight Drive</span>
                        </div>
                    </div>
                </div>

                <!-- Container Resize Settings -->
                <div class="glass-card">
                    <div class="card-header">
                        <h2>Размеры контейнеров</h2>
                    </div>
                    
                    <div class="resize-controls">
                        <button class="glass-button secondary" id="toggle-resize-mode">
                            <svg viewBox="0 0 24 24" class="button-icon">
                                <path d="M12,2A2,2 0 0,1 14,4C14,4.74 13.6,5.39 13,5.73V7.27C13.4,7.61 14.26,8.15 14.26,8.15C14.79,8.68 15.58,8.68 16.11,8.15C16.64,7.62 16.64,6.83 16.11,6.3L15.27,5.46C15.61,5.06 16.74,4 16.74,4C17.27,3.47 18.06,3.47 18.59,4C19.12,4.53 19.12,5.32 18.59,5.85L17.73,6.69C18.07,7.03 19.15,8.15 19.15,8.15C19.68,8.68 19.68,9.47 19.15,10C18.62,10.53 17.83,10.53 17.3,10L16.46,9.16C16.1,9.5 15,10.63 15,10.63C14.47,11.16 13.68,11.16 13.15,10.63C12.62,10.1 12.62,9.31 13.15,8.78L14,7.92C13.74,7.58 13,6.84 13,6.84V18.16C13,18.16 13.74,17.42 14,17.08L13.15,16.22C12.62,15.69 12.62,14.9 13.15,14.37C13.68,13.84 14.47,13.84 15,14.37C15,14.37 16.1,15.5 16.46,15.84L17.3,15C17.83,14.47 18.62,14.47 19.15,15C19.68,15.53 19.68,16.32 19.15,16.85C19.15,16.85 18.07,17.97 17.73,18.31L18.59,19.15C19.12,19.68 19.12,20.47 18.59,21C18.06,21.53 17.27,21.53 16.74,21C16.74,21 15.61,19.94 15.27,19.54L16.11,18.7C16.64,18.17 16.64,17.38 16.11,16.85C15.58,16.32 14.79,16.32 14.26,16.85C14.26,16.85 13.4,17.39 13,17.73V19.27C13.6,19.61 14,20.26 14,21A2,2 0 0,1 12,23A2,2 0 0,1 10,21C10,20.26 10.4,19.61 11,19.27V17.73C10.6,17.39 9.74,16.85 9.74,16.85C9.21,16.32 8.42,16.32 7.89,16.85C7.36,17.38 7.36,18.17 7.89,18.7L8.73,19.54C8.39,19.94 7.26,21 7.26,21C6.73,21.53 5.94,21.53 5.41,21C4.88,20.47 4.88,19.68 5.41,19.15L6.27,18.31C5.93,17.97 4.85,16.85 4.85,16.85C4.32,16.32 4.32,15.53 4.85,15C5.38,14.47 6.17,14.47 6.7,15L7.54,15.84C7.9,15.5 9,14.37 9,14.37C9.53,13.84 10.32,13.84 10.85,14.37C11.38,14.9 11.38,15.69 10.85,16.22L10,17.08C10.26,17.42 11,18.16 11,18.16V6.84C11,6.84 10.26,7.58 10,7.92L10.85,8.78C11.38,9.31 11.38,10.1 10.85,10.63C10.32,11.16 9.53,11.16 9,10.63C9,10.63 7.9,9.5 7.54,9.16L6.7,10C6.17,10.53 5.38,10.53 4.85,10C4.32,9.47 4.32,8.68 4.85,8.15C4.85,8.15 5.93,7.03 6.27,6.69L5.41,5.85C4.88,5.32 4.88,4.53 5.41,4C5.94,3.47 6.73,3.47 7.26,4C7.26,4 8.39,5.06 8.73,5.46L7.89,6.3C7.36,6.83 7.36,7.62 7.89,8.15C8.42,8.68 9.21,8.68 9.74,8.15C9.74,8.15 10.6,7.61 11,7.27V5.73C10.4,5.39 10,4.74 10,4A2,2 0 0,1 12,2Z"/>
                            </svg>
                            Режим изменения размеров
                        </button>
                        <button class="glass-button primary" id="save-resize-changes" style="display: none;">
                            <svg viewBox="0 0 24 24" class="button-icon">
                                <path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"/>
                            </svg>
                            Сохранить изменения
                        </button>
                    </div>
                    <p class="resize-hint" style="display: none;">Наведите курсор на края контейнеров для изменения размеров</p>
                </div>

                <!-- Fullscreen Settings -->
                <div class="glass-card">
                    <div class="card-header">
                        <h2>Полноэкранный режим</h2>
                    </div>
                    
                    <div class="fullscreen-controls">
                        <div class="setting-item">
                            <div class="setting-info">
                                <h3>Автоматический полноэкранный режим</h3>
                                <p>При включении приложение будет автоматически открываться в полноэкранном режиме, скрывая все системные элементы Windows</p>
                            </div>
                            <div class="setting-toggle">
                                <label class="toggle-switch">
                                    <input type="checkbox" id="fullscreen-auto-toggle">
                                    <span class="toggle-slider"></span>
                                </label>
                                <span class="toggle-status" id="fullscreen-status">Выключено</span>
                            </div>
                        </div>
                        
                        <div class="fullscreen-actions">
                            <button class="glass-button primary" id="toggle-fullscreen-now">
                                <svg viewBox="0 0 24 24" class="button-icon">
                                    <path d="M5,5H10V7H7V10H5V5M14,5H19V10H17V7H14V5M17,14H19V19H14V17H17V14M10,17V19H5V14H7V17H10Z"/>
                                </svg>
                                <span id="fullscreen-button-text">Включить полный экран</span>
                            </button>
                            <div class="fullscreen-hint">
                                <strong>F11</strong> - быстрое переключение полноэкранного режима
                            </div>
                        </div>
                    </div>
                </div>
                    
                <!-- App Settings -->
                <div class="glass-card" style="display: none;">
                    <div class="card-header">
                        <h2>Приложение</h2>
                    </div>
                    
                    <div class="app-controls">
                        <button class="glass-button primary" id="install-app" style="display: none;">
                            <svg viewBox="0 0 24 24" class="button-icon">
                                <path d="M5,20H19V18H5M19,9H15V3H9V9H5L12,16L19,9Z"/>
                            </svg>
                            Установить приложение
                        </button>
                        <div class="app-status" id="app-status">
                            Приложение готово к установке
                        </div>
                        <div class="shortcut-info">
                            <div class="shortcut-item">
                                <kbd>Ctrl</kbd> + <kbd>Shift</kbd> + <kbd>1</kbd> - Сделать скриншот
                            </div>
                            <div class="shortcut-item">
                                <strong>Правый клик 4 раза</strong> - Сделать скриншот страницы
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Screenshots History -->
                <div class="glass-card" style="display: none;">
                    <div class="card-header">
                        <h2>История скриншотов</h2>
                        <button class="glass-button secondary" id="clear-screenshots">
                            <svg viewBox="0 0 24 24" class="button-icon">
                                <path d="M6,19A2,2 0 0,0 8,21H16A2,2 0 0,0 18,19V7H6V19Z M8,9H16V19H8V9Z M15.5,4L14.5,3H9.5L8.5,4H5V6H19V4H15.5Z"/>
                            </svg>
                            Очистить историю
                        </button>
                    </div>
                    
                    <div class="screenshots-grid" id="screenshots-grid">
                        <div class="no-screenshots" id="no-screenshots">
                            <svg viewBox="0 0 24 24" class="empty-icon">
                                <path d="M9,2V8H7V2H9M13,2V8H11V2H13M17,2V8H15V2H17M19,9H5A2,2 0 0,0 3,11V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V11A2,2 0 0,0 19,9Z"/>
                            </svg>
                            <p>Пока нет скриншотов</p>
                            <p class="hint">Нажмите правой кнопкой мыши 4 раза для создания скриншота</p>
                        </div>
                    </div>
                </div>

                <!-- Community Chat System -->
                <div class="glass-card">
                    <div class="card-header">
                        <h2>Сообщество игроков</h2>
                        <div class="community-actions">
                            <button class="glass-button secondary" id="sync-community" title="Синхронизовать с сообществом">
                                <svg viewBox="0 0 24 24" class="button-icon">
                                    <path d="M12,18A6,6 0 0,1 6,12A6,6 0 0,1 12,6A6,6 0 0,1 18,12A6,6 0 0,1 12,18M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2Z"/>
                                </svg>
                            </button>
                            <button class="glass-button primary" id="add-community-message">
                                <svg viewBox="0 0 24 24" class="button-icon">
                                    <path d="M20,2H4A2,2 0 0,0 2,4V22L6,18H20A2,2 0 0,0 22,16V4A2,2 0 0,0 20,2M6,9H18V11H6V9M14,14H6V12H14V14M18,8H6V6H18V8Z"/>
                                </svg>
                                Написать сообщение
                            </button>
                        </div>
                    </div>
                    
                    <div class="community-status">
                        <div class="status-indicator" id="community-status-dot"></div>
                        <span id="community-status-text">Локальный режим</span>
                        <span class="community-users" id="community-users">1 пользователь</span>
                    </div>
                    
                    <div class="community-messages" id="community-messages">
                        <div class="message-item system-message">
                            <div class="message-avatar">
                                <svg viewBox="0 0 24 24" style="width: 20px; height: 20px; fill: currentColor;">
                                    <path d="M17.753,14C17.258,14.93 16.421,15.7 15.336,16.1C15.243,15.74 15.09,15.39 14.884,15.07C15.728,14.74 16.417,14.15 16.861,13.4C16.624,13.14 16.34,12.86 16.02,12.57C16.341,12.83 16.624,13.11 16.861,13.4C16.9,13.33 16.938,13.26 16.975,13.18L15.045,11.25C14.93,11.405 14.795,11.545 14.645,11.67L12.72,9.745C12.845,9.595 12.985,9.46 13.14,9.345L11.21,7.415C11.07,7.505 10.92,7.58 10.77,7.64C10.64,7.42 10.5,7.2 10.36,6.98C10.53,6.91 10.7,6.83 10.86,6.74L8.88,4.76C8.85,4.79 8.82,4.82 8.79,4.85C8.82,4.82 8.85,4.79 8.88,4.76L8.67,4.55C8.61,4.61 8.54,4.67 8.47,4.74C8.54,4.67 8.61,4.61 8.67,4.55L8.46,4.34C8.4,4.4 8.33,4.46 8.26,4.53C8.33,4.46 8.4,4.4 8.46,4.34L8.25,4.13C8.19,4.19 8.12,4.25 8.05,4.32C8.12,4.25 8.19,4.19 8.25,4.13L8.04,3.92C7.96,4 7.87,4.09 7.78,4.18C7.87,4.09 7.96,4 8.04,3.92L7.83,3.71C7.75,3.79 7.66,3.88 7.57,3.97C7.66,3.88 7.75,3.79 7.83,3.71L7.62,3.5C7.54,3.58 7.45,3.67 7.36,3.76C7.45,3.67 7.54,3.58 7.62,3.5L7.41,3.29C7.33,3.37 7.24,3.46 7.15,3.55C7.24,3.46 7.33,3.37 7.41,3.29L7.2,3.08C7.12,3.16 7.03,3.25 6.94,3.34C7.03,3.25 7.12,3.16 7.2,3.08L6.99,2.87C6.91,2.95 6.82,3.04 6.73,3.13C6.82,3.04 6.91,2.95 6.99,2.87L6.78,2.66C6.7,2.74 6.61,2.83 6.52,2.92C6.61,2.83 6.7,2.74 6.78,2.66L6.57,2.45C6.49,2.53 6.4,2.62 6.31,2.71C6.4,2.62 6.49,2.53 6.57,2.45L6.36,2.24C6.28,2.32 6.19,2.41 6.1,2.5C6.19,2.41 6.28,2.32 6.36,2.24L6.15,2.03C6.07,2.11 5.98,2.2 5.89,2.29C5.98,2.2 6.07,2.11 6.15,2.03L5.94,1.82C5.86,1.9 5.77,1.99 5.68,2.08C5.77,1.99 5.86,1.9 5.94,1.82L5.73,1.61C5.65,1.69 5.56,1.78 5.47,1.87C5.56,1.78 5.65,1.69 5.73,1.61L5.52,1.4C5.44,1.48 5.35,1.57 5.26,1.66C5.35,1.57 5.44,1.48 5.52,1.4L5.31,1.19C5.23,1.27 5.14,1.36 5.05,1.45C5.14,1.36 5.23,1.27 5.31,1.19L5.1,0.98C5.02,1.06 4.93,1.15 4.84,1.24C4.93,1.15 5.02,1.06 5.1,0.98L4.89,0.77C4.81,0.85 4.72,0.94 4.63,1.03C4.72,0.94 4.81,0.85 4.89,0.77L4.68,0.56C4.6,0.64 4.51,0.73 4.42,0.82C4.51,0.73 4.6,0.64 4.68,0.56L4.47,0.35C4.39,0.43 4.3,0.52 4.21,0.61C4.3,0.52 4.39,0.43 4.47,0.35L4.26,0.14C4.18,0.22 4.09,0.31 4,0.4C4.09,0.31 4.18,0.22 4.26,0.14L4.05,-0.07C3.97,0.01 3.88,0.1 3.79,0.19C3.88,0.1 3.97,0.01 4.05,-0.07L3.84,-0.28C3.76,-0.2 3.67,-0.11 3.58,-0.02C3.67,-0.11 3.76,-0.2 3.84,-0.28L3.63,-0.49C3.55,-0.41 3.46,-0.32 3.37,-0.23C3.46,-0.32 3.55,-0.41 3.63,-0.49L3.42,-0.7C3.34,-0.62 3.25,-0.53 3.16,-0.44C3.25,-0.53 3.34,-0.62 3.42,-0.7L3.21,-0.91C3.13,-0.83 3.04,-0.74 2.95,-0.65C3.04,-0.74 3.13,-0.83 3.21,-0.91L3,-1.12C2.92,-1.04 2.83,-0.95 2.74,-0.86C2.83,-0.95 2.92,-1.04 3,-1.12L2.79,-1.33C2.71,-1.25 2.62,-1.16 2.53,-1.07C2.62,-1.16 2.71,-1.25 2.79,-1.33L2.58,-1.54C2.5,-1.46 2.41,-1.37 2.32,-1.28C2.41,-1.37 2.5,-1.46 2.58,-1.54L2.37,-1.75C2.29,-1.67 2.2,-1.58 2.11,-1.49C2.2,-1.58 2.29,-1.67 2.37,-1.75L2.16,-1.96C2.08,-1.88 1.99,-1.79 1.9,-1.7C1.99,-1.79 2.08,-1.88 2.16,-1.96L1.95,-2.17C1.87,-2.09 1.78,-2 1.69,-1.91C1.78,-2 1.87,-2.09 1.95,-2.17L1.74,-2.38C1.66,-2.3 1.57,-2.21 1.48,-2.12C1.57,-2.21 1.66,-2.3 1.74,-2.38L1.53,-2.59C1.45,-2.51 1.36,-2.42 1.27,-2.33C1.36,-2.42 1.45,-2.51 1.53,-2.59L1.32,-2.8C1.24,-2.72 1.15,-2.63 1.06,-2.54C1.15,-2.63 1.24,-2.72 1.32,-2.8L1.11,-3.01C1.03,-2.93 0.94,-2.84 0.85,-2.75C0.94,-2.84 1.03,-2.93 1.11,-3.01L0.9,-3.22C0.82,-3.14 0.73,-3.05 0.64,-2.96C0.73,-3.05 0.82,-3.14 0.9,-3.22L0.69,-3.43C0.61,-3.35 0.52,-3.26 0.43,-3.17C0.52,-3.26 0.61,-3.35 0.69,-3.43L0.48,-3.64C0.4,-3.56 0.31,-3.47 0.22,-3.38C0.31,-3.47 0.4,-3.56 0.48,-3.64L0.27,-3.85C0.19,-3.77 0.1,-3.68 0.01,-3.59C0.1,-3.68 0.19,-3.77 0.27,-3.85L0.06,-4.06C-0.02,-3.98 -0.11,-3.89 -0.2,-3.8C-0.11,-3.89 -0.02,-3.98 0.06,-4.06L-0.15,-4.27C-0.23,-4.19 -0.32,-4.1 -0.41,-4.01C-0.32,-4.1 -0.23,-4.19 -0.15,-4.27L-0.36,-4.48C-0.44,-4.4 -0.53,-4.31 -0.62,-4.22C-0.53,-4.31 -0.44,-4.4 -0.36,-4.48L-0.57,-4.69C-0.65,-4.61 -0.74,-4.52 -0.83,-4.43C-0.74,-4.52 -0.65,-4.61 -0.57,-4.69L-0.78,-4.9C-0.86,-4.82 -0.95,-4.73 -1.04,-4.64C-0.95,-4.73 -0.86,-4.82 -0.78,-4.9L-0.99,-5.11C-1.07,-5.03 -1.16,-4.94 -1.25,-4.85C-1.16,-4.94 -1.07,-5.03 -0.99,-5.11L-1.2,-5.32C-1.28,-5.24 -1.37,-5.15 -1.46,-5.06C-1.37,-5.15 -1.28,-5.24 -1.2,-5.32L-1.41,-5.53C-1.49,-5.45 -1.58,-5.36 -1.67,-5.27C-1.58,-5.36 -1.49,-5.45 -1.41,-5.53L-1.62,-5.74C-1.7,-5.66 -1.79,-5.57 -1.88,-5.48C-1.79,-5.57 -1.7,-5.66 -1.62,-5.74L-1.83,-5.95C-1.91,-5.87 -2,-5.78 -2.09,-5.69C-2,-5.78 -1.91,-5.87 -1.83,-5.95L-2.04,-6.16C-2.12,-6.08 -2.21,-5.99 -2.3,-5.9C-2.21,-5.99 -2.12,-6.08 -2.04,-6.16L-2.25,-6.37C-2.33,-6.29 -2.42,-6.2 -2.51,-6.11C-2.42,-6.2 -2.33,-6.29 -2.25,-6.37L-2.46,-6.58C-2.54,-6.5 -2.63,-6.41 -2.72,-6.32C-2.63,-6.41 -2.54,-6.5 -2.46,-6.58L-2.67,-6.79C-2.75,-6.71 -2.84,-6.62 -2.93,-6.53C-2.84,-6.62 -2.75,-6.71 -2.67,-6.79L-2.88,-7C-2.96,-6.92 -3.05,-6.83 -3.14,-6.74C-3.05,-6.83 -2.96,-6.92 -2.88,-7L-3.09,-7.21C-3.17,-7.13 -3.26,-7.04 -3.35,-6.95C-3.26,-7.04 -3.17,-7.13 -3.09,-7.21L-3.3,-7.42C-3.38,-7.34 -3.47,-7.25 -3.56,-7.16C-3.47,-7.25 -3.38,-7.34 -3.3,-7.42L-3.51,-7.63C-3.59,-7.55 -3.68,-7.46 -3.77,-7.37C-3.68,-7.46 -3.59,-7.55 -3.51,-7.63L-3.72,-7.84C-3.8,-7.76 -3.89,-7.67 -3.98,-7.58C-3.89,-7.67 -3.8,-7.76 -3.72,-7.84L-3.93,-8.05C-4.01,-7.97 -4.1,-7.88 -4.19,-7.79C-4.1,-7.88 -4.01,-7.97 -3.93,-8.05L-4.14,-8.26C-4.22,-8.18 -4.31,-8.09 -4.4,-8C-4.31,-8.09 -4.22,-8.18 -4.14,-8.26L-4.35,-8.47C-4.43,-8.39 -4.52,-8.3 -4.61,-8.21C-4.52,-8.3 -4.43,-8.39 -4.35,-8.47L-4.56,-8.68C-4.64,-8.6 -4.73,-8.51 -4.82,-8.42C-4.73,-8.51 -4.64,-8.6 -4.56,-8.68L-4.77,-8.89C-4.85,-8.81 -4.94,-8.72 -5.03,-8.63C-4.94,-8.72 -4.85,-8.81 -4.77,-8.89L-4.98,-9.1C-5.06,-9.02 -5.15,-8.93 -5.24,-8.84C-5.15,-8.93 -5.06,-9.02 -4.98,-9.1L-5.19,-9.31C-5.27,-9.23 -5.36,-9.14 -5.45,-9.05C-5.36,-9.14 -5.27,-9.23 -5.19,-9.31L-5.4,-9.52C-5.48,-9.44 -5.57,-9.35 -5.66,-9.26C-5.57,-9.35 -5.48,-9.44 -5.4,-9.52L-5.61,-9.73C-5.69,-9.65 -5.78,-9.56 -5.87,-9.47C-5.78,-9.56 -5.69,-9.65 -5.61,-9.73L-5.82,-9.94C-5.9,-9.86 -5.99,-9.77 -6.08,-9.68C-5.99,-9.77 -5.9,-9.86 -5.82,-9.94L-6.03,-10.15C-6.11,-10.07 -6.2,-9.98 -6.29,-9.89C-6.2,-9.98 -6.11,-10.07 -6.03,-10.15L-6.24,-10.36C-6.32,-10.28 -6.41,-10.19 -6.5,-10.1C-6.41,-10.19 -6.32,-10.28 -6.24,-10.36L-6.45,-10.57C-6.53,-10.49 -6.62,-10.4 -6.71,-10.31C-6.62,-10.4 -6.53,-10.49 -6.45,-10.57L-6.66,-10.78C-6.74,-10.7 -6.83,-10.61 -6.92,-10.52C-6.83,-10.61 -6.74,-10.7 -6.66,-10.78L-6.87,-10.99C-6.95,-10.91 -7.04,-10.82 -7.13,-10.73C-7.04,-10.82 -6.95,-10.91 -6.87,-10.99L-7.08,-11.2C-7.16,-11.12 -7.25,-11.03 -7.34,-10.94C-7.25,-11.03 -7.16,-11.12 -7.08,-11.2L-7.29,-11.41C-7.37,-11.33 -7.46,-11.24 -7.55,-11.15C-7.46,-11.24 -7.37,-11.33 -7.29,-11.41L-7.5,-11.62C-7.58,-11.54 -7.67,-11.45 -7.76,-11.36C-7.67,-11.45 -7.58,-11.54 -7.5,-11.62L-7.71,-11.83C-7.79,-11.75 -7.88,-11.66 -7.97,-11.57C-7.88,-11.66 -7.79,-11.75 -7.71,-11.83L-7.92,-12.04C-8,-11.96 -8.09,-11.87 -8.18,-11.78C-8.09,-11.87 -8,-11.96 -7.92,-12.04L-8.13,-12.25C-8.21,-12.17 -8.3,-12.08 -8.39,-11.99C-8.3,-12.08 -8.21,-12.17 -8.13,-12.25L-8.34,-12.46C-8.42,-12.38 -8.51,-12.29 -8.6,-12.2C-8.51,-12.29 -8.42,-12.38 -8.34,-12.46L-8.55,-12.67C-8.63,-12.59 -8.72,-12.5 -8.81,-12.41C-8.72,-12.5 -8.63,-12.59 -8.55,-12.67L-8.76,-12.88C-8.84,-12.8 -8.93,-12.71 -9.02,-12.62C-8.93,-12.71 -8.84,-12.8 -8.76,-12.88L-8.97,-13.09C-9.05,-13.01 -9.14,-12.92 -9.23,-12.83C-9.14,-12.92 -9.05,-13.01 -8.97,-13.09L-9.18,-13.3C-9.26,-13.22 -9.35,-13.13 -9.44,-13.04C-9.35,-13.13 -9.26,-13.22 -9.18,-13.3L-9.39,-13.51C-9.47,-13.43 -9.56,-13.34 -9.65,-13.25C-9.56,-13.34 -9.47,-13.43 -9.39,-13.51L-9.6,-13.72C-9.68,-13.64 -9.77,-13.55 -9.86,-13.46C-9.77,-13.55 -9.68,-13.64 -9.6,-13.72L-9.81,-13.93C-9.89,-13.85 -9.98,-13.76 -10.07,-13.67C-9.98,-13.76 -9.89,-13.85 -9.81,-13.93L-10.02,-14.14C-10.1,-14.06 -10.19,-13.97 -10.28,-13.88C-10.19,-13.97 -10.1,-14.06 -10.02,-14.14L-10.23,-14.35C-10.31,-14.27 -10.4,-14.18 -10.49,-14.09C-10.4,-14.18 -10.31,-14.27 -10.23,-14.35L-10.44,-14.56C-10.52,-14.48 -10.61,-14.39 -10.7,-14.3C-10.61,-14.39 -10.52,-14.48 -10.44,-14.56L-10.65,-14.77C-10.73,-14.69 -10.82,-14.6 -10.91,-14.51C-10.82,-14.6 -10.73,-14.69 -10.65,-14.77L-10.86,-14.98C-10.94,-14.9 -11.03,-14.81 -11.12,-14.72C-11.03,-14.81 -10.94,-14.9 -10.86,-14.98L-11.07,-15.19C-11.15,-15.11 -11.24,-15.02 -11.33,-14.93C-11.24,-15.02 -11.15,-15.11 -11.07,-15.19L-11.28,-15.4C-11.36,-15.32 -11.45,-15.23 -11.54,-15.14C-11.45,-15.23 -11.36,-15.32 -11.28,-15.4L-11.49,-15.61C-11.57,-15.53 -11.66,-15.44 -11.75,-15.35C-11.66,-15.44 -11.57,-15.53 -11.49,-15.61L-11.7,-15.82C-11.78,-15.74 -11.87,-15.65 -11.96,-15.56C-11.87,-15.65 -11.78,-15.74 -11.7,-15.82L-11.91,-16.03C-11.99,-15.95 -12.08,-15.86 -12.17,-15.77C-12.08,-15.86 -11.99,-15.95 -11.91,-16.03L-12.12,-16.24C-12.2,-16.16 -12.29,-16.07 -12.38,-15.98C-12.29,-16.07 -12.2,-16.16 -12.12,-16.24L-12.33,-16.45C-12.41,-16.37 -12.5,-16.28 -12.59,-16.19C-12.5,-16.28 -12.41,-16.37 -12.33,-16.45L-12.54,-16.66C-12.62,-16.58 -12.71,-16.49 -12.8,-16.4C-12.71,-16.49 -12.62,-16.58 -12.54,-16.66L-12.75,-16.87C-12.83,-16.79 -12.92,-16.7 -13.01,-16.61C-12.92,-16.7 -12.83,-16.79 -12.75,-16.87L-12.96,-17.08C-13.04,-17 -13.13,-16.91 -13.22,-16.82C-13.13,-16.91 -13.04,-17 -12.96,-17.08L-13.17,-17.29C-13.25,-17.21 -13.34,-17.12 -13.43,-17.03C-13.34,-17.12 -13.25,-17.21 -13.17,-17.29L-13.38,-17.5C-13.46,-17.42 -13.55,-17.33 -13.64,-17.24C-13.55,-17.33 -13.46,-17.42 -13.38,-17.5L-13.59,-17.71C-13.67,-17.63 -13.76,-17.54 -13.85,-17.45C-13.76,-17.54 -13.67,-17.63 -13.59,-17.71L-13.8,-17.92C-13.88,-17.84 -13.97,-17.75 -14.06,-17.66C-13.97,-17.75 -13.88,-17.84 -13.8,-17.92L-14.01,-18.13C-14.09,-18.05 -14.18,-17.96 -14.27,-17.87C-14.18,-17.96 -14.09,-18.05 -14.01,-18.13L-14.22,-18.34C-14.3,-18.26 -14.39,-18.17 -14.48,-18.08C-14.39,-18.17 -14.3,-18.26 -14.22,-18.34L-14.43,-18.55C-14.51,-18.47 -14.6,-18.38 -14.69,-18.29C-14.6,-18.38 -14.51,-18.47 -14.43,-18.55L-14.64,-18.76C-14.72,-18.68 -14.81,-18.59 -14.9,-18.5C-14.81,-18.59 -14.72,-18.68 -14.64,-18.76L-14.85,-18.97C-14.93,-18.89 -15.02,-18.8 -15.11,-18.71C-15.02,-18.8 -14.93,-18.89 -14.85,-18.97L-15.06,-19.18C-15.14,-19.1 -15.23,-19.01 -15.32,-18.92C-15.23,-19.01 -15.14,-19.1 -15.06,-19.18L-15.27,-19.39C-15.35,-19.31 -15.44,-19.22 -15.53,-19.13C-15.44,-19.22 -15.35,-19.31 -15.27,-19.39L-15.48,-19.6C-15.56,-19.52 -15.65,-19.43 -15.74,-19.34C-15.65,-19.43 -15.56,-19.52 -15.48,-19.6L-15.69,-19.81C-15.77,-19.73 -15.86,-19.64 -15.95,-19.55C-15.86,-19.64 -15.77,-19.73 -15.69,-19.81L-15.9,-20.02C-15.98,-19.94 -16.07,-19.85 -16.16,-19.76C-16.07,-19.85 -15.98,-19.94 -15.9,-20.02L-16.11,-20.23C-16.19,-20.15 -16.28,-20.06 -16.37,-19.97C-16.28,-20.06 -16.19,-20.15 -16.11,-20.23L-16.32,-20.44C-16.4,-20.36 -16.49,-20.27 -16.58,-20.18C-16.49,-20.27 -16.4,-20.36 -16.32,-20.44L-16.53,-20.65C-16.61,-20.57 -16.7,-20.48 -16.79,-20.39C-16.7,-20.48 -16.61,-20.57 -16.53,-20.65L-16.74,-20.86C-16.82,-20.78 -16.91,-20.69 -17,-20.6C-16.91,-20.69 -16.82,-20.78 -16.74,-20.86L-16.95,-21.07C-17.03,-20.99 -17.12,-20.9 -17.21,-20.81C-17.12,-20.9 -17.03,-20.99 -16.95,-21.07L-17.16,-21.28C-17.24,-21.2 -17.33,-21.11 -17.42,-21.02C-17.33,-21.11 -17.24,-21.2 -17.16,-21.28L-17.37,-21.49C-17.45,-21.41 -17.54,-21.32 -17.63,-21.23C-17.54,-21.32 -17.45,-21.41 -17.37,-21.49L-17.58,-21.7C-17.66,-21.62 -17.75,-21.53 -17.84,-21.44C-17.75,-21.53 -17.66,-21.62 -17.58,-21.7L-17.79,-21.91C-17.87,-21.83 -17.96,-21.74 -18.05,-21.65C-17.96,-21.74 -17.87,-21.83 -17.79,-21.91L-18,-22.12C-18.08,-22.04 -18.17,-21.95 -18.26,-21.86C-18.17,-21.95 -18.08,-22.04 -18,-22.12Z"/>
                                </svg>
                            </div>
                            <div class="message-content">
                                <div class="message-header">
                                    <span class="message-author">Система</span>
                                    <span class="message-time">сейчас</span>
                                </div>
                                <div class="message-text">Добро пожаловать в сообщество! Здесь вы можете общаться с другими игроками, делиться достижениями и обсуждать стратегии.</div>
                            </div>
                        </div>
                        
                        <div class="message-item">
                            <div class="message-avatar">
                                <svg viewBox="0 0 24 24" style="width: 20px; height: 20px; fill: currentColor;">
                                    <path d="M12,4A4,4 0 0,1 16,8A4,4 0 0,1 12,12A4,4 0 0,1 8,8A4,4 0 0,1 12,4M12,14C16.42,14 20,15.79 20,18V20H4V18C4,15.79 7.58,14 12,14Z"/>
                                </svg>
                            </div>
                            <div class="message-content">
                                <div class="message-header">
                                    <span class="message-author">Администратор</span>
                                    <span class="message-time">сегодня</span>
                                </div>
                                <div class="message-text">Приложение поддерживает синхронизацию через GitHub или Firebase. Включите синхронизацию для общения с другими пользователями!</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="community-input-section">
                        <div class="community-input">
                            <input type="text" id="community-message-input" class="glass-input" placeholder="Напишите сообщение...">
                            <button class="send-message-btn" id="send-community-message">
                                <svg viewBox="0 0 24 24">
                                    <path d="M2,21L23,12L2,3V10L17,12L2,14V21Z"/>
                                </svg>
                            </button>
                        </div>
                        <div class="message-options">
                            <label class="message-option">
                                <input type="checkbox" id="anonymous-mode">
                                <span>Анонимно</span>
                            </label>
                            <span class="message-counter" id="message-counter">0/280</span>
                        </div>
                    </div>
                </div>

                <!-- Sync Settings -->
                <div class="glass-card">
                    <div class="card-header">
                        <h2>Синхронизация данных</h2>
                    </div>
                    
                    <div class="sync-options">
                        <div class="sync-option">
                            <div class="sync-icon">
                                <svg viewBox="0 0 24 24" style="width: 24px; height: 24px; fill: currentColor;">
                                    <path d="M12,18A6,6 0 0,1 6,12C6,11 6.25,10.03 6.7,9.2L5.24,7.74C4.46,8.97 4,10.43 4,12A8,8 0 0,0 12,20V23L16,19L12,15M12,4V1L8,5L12,9V6A6,6 0 0,1 18,12C18,13 17.75,13.97 17.3,14.8L18.76,16.26C19.54,15.03 20,13.57 20,12A8,8 0 0,0 12,4Z"/>
                                </svg>
                            </div>
                            <div class="sync-info">
                                <h3>Локальное хранение</h3>
                                <p>Данные сохраняются только на этом устройстве</p>
                            </div>
                            <div class="sync-status active">Активно</div>
                        </div>
                        
                        <div class="sync-option" id="github-sync-option">
                            <div class="sync-icon">
                                <svg viewBox="0 0 24 24" style="width: 24px; height: 24px; fill: currentColor;">
                                    <path d="M12,2A10,10 0 0,0 2,12C2,16.42 4.87,20.17 8.84,21.5C9.34,21.58 9.5,21.27 9.5,21C9.5,20.77 9.5,20.14 9.5,19.31C6.73,19.91 6.14,17.97 6.14,17.97C5.68,16.81 5.03,16.5 5.03,16.5C4.12,15.88 5.1,15.9 5.1,15.9C6.1,15.97 6.63,16.93 6.63,16.93C7.5,18.45 8.97,18 9.54,17.76C9.63,17.11 9.89,16.67 10.17,16.42C7.95,16.17 5.62,15.31 5.62,11.5C5.62,10.39 6,9.5 6.65,8.79C6.55,8.54 6.2,7.5 6.75,6.15C6.75,6.15 7.59,5.88 9.5,7.17C10.29,6.95 11.15,6.84 12,6.84C12.85,6.84 13.71,6.95 14.5,7.17C16.41,5.88 17.25,6.15 17.25,6.15C17.8,7.5 17.45,8.54 17.35,8.79C18,9.5 18.38,10.39 18.38,11.5C18.38,15.32 16.04,16.16 13.81,16.41C14.17,16.72 14.5,17.33 14.5,18.26C14.5,19.6 14.5,20.68 14.5,21C14.5,21.27 14.66,21.59 15.17,21.5C19.14,20.16 22,16.42 22,12A10,10 0 0,0 12,2Z"/>
                                </svg>
                            </div>
                            <div class="sync-info">
                                <h3>GitHub Gists</h3>
                                <p>Синхронизация через публичные Gists (бесплатно)</p>
                            </div>
                            <div class="sync-status">Настроить</div>
                        </div>
                        
                        <div class="sync-option" id="firebase-sync-option">
                            <div class="sync-icon">
                                <svg viewBox="0 0 24 24" style="width: 24px; height: 24px; fill: currentColor;">
                                    <path d="M5.84 2.1C5.76 1.98 5.64 1.88 5.5 1.82C5.23 1.67 4.89 1.76 4.74 2.03L.79 8.58C.64 8.85 .73 9.19 1 9.34C1.27 9.49 1.61 9.4 1.76 9.13L5.84 2.1M17.89 2.1L21.97 9.13C22.12 9.4 22.46 9.49 22.73 9.34C23 9.19 23.09 8.85 22.94 8.58L18.99 2.03C18.84 1.76 18.5 1.67 18.23 1.82C18.09 1.88 17.97 1.98 17.89 2.1M12 4.15L10 8.3L12 12L14 8.3L12 4.15M3.5 10.85L11.5 12L12 21.5L3.5 10.85M20.5 10.85L12 21.5L12.5 12L20.5 10.85Z"/>
                                </svg>
                            </div>
                            <div class="sync-info">
                                <h3>Firebase</h3>
                                <p>Реальное время, 1GB бесплатно</p>
                            </div>
                            <div class="sync-status">Настроить</div>
                        </div>
                        
                        <div class="sync-option" id="qr-sync-option">
                            <div class="sync-icon">
                                <svg viewBox="0 0 24 24" style="width: 24px; height: 24px; fill: currentColor;">
                                    <path d="M3,11H5V13H3V11M11,5H13V9H11V5M9,11H13V15H9V11M15,11H17V13H15V11M19,5H21V9H19V5M5,3H9V7H5V3M3,5H1V9H3V5M3,19H1V15H3V19M19,3H21V7H19V3M15,21H17V19H15V21M15,19H17V17H15V19M21,15H19V19H21V15M13,3H11V1H13V3M21,11H23V9H21V11M13,21H15V23H13V21M3,15H5V17H3V15M5,19H9V23H5V19M19,19H23V23H19V19M15,5H17V9H15V5M11,19H13V21H11V19M7,15H9V17H7V15M11,15H13V17H11V15M9,5H11V7H9V5Z"/>
                                </svg>
                            </div>
                            <div class="sync-info">
                                <h3>QR-коды</h3>
                                <p>Обмен данными через QR-коды</p>
                            </div>
                            <div class="sync-status">Генерировать</div>
                        </div>
                    </div>
                    
                    <div class="sync-actions">
                        <button class="glass-button secondary" id="export-data">
                            <svg viewBox="0 0 24 24" class="button-icon">
                                <path d="M14,2H6A2,2 0 0,0 4,4V20A2,2 0 0,0 6,22H18A2,2 0 0,0 20,20V8L14,2M18,20H6V4H13V9H18V20Z"/>
                            </svg>
                            Экспорт данных
                        </button>
                        <button class="glass-button primary" id="import-data">
                            <svg viewBox="0 0 24 24" class="button-icon">
                                <path d="M14,2H6A2,2 0 0,0 4,4V20A2,2 0 0,0 6,22H18A2,2 0 0,0 20,20V8L14,2M18,20H6V4H13V9H18V20Z"/>
                            </svg>
                            Импорт данных
                        </button>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- Мобильная навигация снизу - показывается только на мобильных -->
    <nav class="mobile-bottom-nav">
        <div class="mobile-nav-item active" data-tab="home">
            <svg class="mobile-nav-icon" viewBox="0 0 24 24">
                <path d="M12 2L2 7v10c0 5.55 3.84 10 9 11 1.16.21 2.34.21 3.5 0 5.16-1 9-5.45 9-11V7l-10-5z"/>
            </svg>
            <span class="mobile-nav-label">Главная</span>
        </div>
        <div class="mobile-nav-item" data-tab="players">
            <svg class="mobile-nav-icon" viewBox="0 0 24 24">
                <path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"/>
            </svg>
            <span class="mobile-nav-label">Игроки</span>
        </div>
        <div class="mobile-nav-item" data-tab="stats">
            <svg class="mobile-nav-icon" viewBox="0 0 24 24">
                <path d="M3.5 18.49l6-6.01 4 4L22 6.92l-1.41-1.41-7.09 7.97-4-4L2 16.99z"/>
            </svg>
            <span class="mobile-nav-label">Статистика</span>
        </div>
        <!-- ВРЕМЕННО СКРЫТА кнопка Сообщество в мобильной навигации -->
        <div class="mobile-nav-item" data-tab="community" style="display: none !important;">
            <svg class="mobile-nav-icon" viewBox="0 0 24 24">
                <path d="M12,5.5A3.5,3.5 0 0,1 15.5,9A3.5,3.5 0 0,1 12,12.5A3.5,3.5 0 0,1 8.5,9A3.5,3.5 0 0,1 12,5.5M5,8C5.56,8 6.08,8.15 6.53,8.42C6.38,9.85 6.8,11.27 7.66,12.38C7.16,13.34 6.16,14 5,14A3,3 0 0,1 2,11A3,3 0 0,1 5,8M19,8A3,3 0 0,1 22,11A3,3 0 0,1 19,14C17.84,14 16.84,13.34 16.34,12.38C17.2,11.27 17.62,9.85 17.47,8.42C17.92,8.15 18.44,8 19,8M5.5,18.25C5.5,16.18 8.41,14.5 12,14.5C15.59,14.5 18.5,16.18 18.5,18.25V20H5.5V18.25M0,20V18.5C0,17.11 1.89,15.94 4.45,15.6C3.86,16.28 3.5,17.22 3.5,18.25V20H0M24,20H20.5V18.25C20.5,17.22 20.14,16.28 19.55,15.6C22.11,15.94 24,17.11 24,18.5V20Z"/>
            </svg>
            <span class="mobile-nav-label">Сообщество</span>
        </div>
        <div class="mobile-nav-item" data-tab="settings">
            <svg class="mobile-nav-icon" viewBox="0 0 24 24">
                <path d="M19.14,12.94c0.04-0.3,0.06-0.61,0.06-0.94c0-0.32-0.02-0.64-0.07-0.94l2.03-1.58c0.18-0.14,0.23-0.41,0.12-0.61 l-1.92-3.32c-0.12-0.22-0.37-0.29-0.59-0.22l-2.39,0.96c-0.5-0.38-1.03-0.7-1.62-0.94L14.4,2.81c-0.04-0.24-0.24-0.41-0.48-0.41 h-3.84c-0.24,0-0.43,0.17-0.47,0.41L9.25,5.35C8.66,5.59,8.12,5.92,7.63,6.29L5.24,5.33c-0.22-0.08-0.47,0-0.59,0.22L2.74,8.87 C2.62,9.08,2.66,9.34,2.86,9.48l2.03,1.58C4.84,11.36,4.82,11.69,4.82,12s0.02,0.64,0.07,0.94l-2.03,1.58 c-0.18,0.14-0.23,0.41-0.12,0.61l1.92,3.32c0.12,0.22,0.37,0.29,0.59,0.22l2.39-0.96c0.5,0.38,1.03,0.7,1.62,0.94l0.36,2.54 c0.05,0.24,0.24,0.41,0.48,0.41h3.84c0.24,0,0.44-0.17,0.47-0.41l0.36-2.54c0.59-0.24,1.13-0.56,1.62-0.94l2.39,0.96 c0.22,0.08,0.47,0,0.59-0.22l1.92-3.32c0.12-0.22,0.07-0.47-0.12-0.61L19.14,12.94z M12,15.6c-1.98,0-3.6-1.62-3.6-3.6 s1.62-3.6,3.6-3.6s3.6,1.62,3.6,3.6S13.98,15.6,12,15.6z"/>
            </svg>
            <span class="mobile-nav-label">Настройки</span>
        </div>
    </nav>

    <!-- System Status Indicator -->
    <div class="system-status-indicator" id="system-status-indicator">
        <div class="status-toggle" id="status-toggle">
            <div class="status-icon">
                <svg viewBox="0 0 24 24" class="status-svg">
                    <circle cx="12" cy="12" r="10" fill="none" stroke="currentColor" stroke-width="2"/>
                    <circle cx="12" cy="12" r="3" fill="currentColor"/>
                </svg>
            </div>
            <div class="status-dot" id="main-status-dot"></div>
        </div>
        
        <div class="status-panel" id="status-panel">
            <div class="status-header">
                <h4>Состояние системы</h4>
                <div class="status-time" id="status-time">--:--:--</div>
            </div>
            
            <div class="status-items">
                <div class="status-item">
                    <div class="status-label">Приложение</div>
                    <div class="status-value">
                        <span class="status-indicator" id="app-status-indicator"></span>
                        <span id="app-status-text">Загрузка...</span>
                    </div>
                </div>
                
                <div class="status-item">
                    <div class="status-label">DOM</div>
                    <div class="status-value">
                        <span class="status-indicator" id="dom-status-indicator"></span>
                        <span id="dom-status-text">Проверка...</span>
                    </div>
                </div>
                
                <div class="status-item">
                    <div class="status-label">Скрипты</div>
                    <div class="status-value">
                        <span class="status-indicator" id="scripts-status-indicator"></span>
                        <span id="scripts-status-text">Загрузка...</span>
                    </div>
                </div>
                
                <div class="status-item">
                    <div class="status-label">Фон</div>
                    <div class="status-value">
                        <span class="status-indicator" id="background-status-indicator"></span>
                        <span id="background-status-text">Ожидание...</span>
                    </div>
                </div>
                
                <div class="status-item">
                    <div class="status-label">Данные</div>
                    <div class="status-value">
                        <span class="status-indicator" id="data-status-indicator"></span>
                        <span id="data-status-text">Не загружены</span>
                    </div>
                </div>
                
                <div class="status-item">
                    <div class="status-label">PWA</div>
                    <div class="status-value">
                        <span class="status-indicator" id="pwa-status-indicator"></span>
                        <span id="pwa-status-text">Проверка...</span>
                    </div>
                </div>
                
                <div class="status-item">
                    <div class="status-label">Память</div>
                    <div class="status-value">
                        <span class="status-indicator" id="memory-status-indicator"></span>
                        <span id="memory-status-text">--</span>
                    </div>
                </div>
                
                <div class="status-item">
                    <div class="status-label">Производительность</div>
                    <div class="status-value">
                        <span class="status-indicator" id="performance-status-indicator"></span>
                        <span id="performance-status-text">--</span>
                    </div>
                </div>
            </div>
            
            <div class="status-footer">
                <div class="status-actions">
                    <button class="status-btn" id="refresh-status" title="Обновить статус">
                        <svg viewBox="0 0 24 24">
                            <path d="M17.65,6.35C16.2,4.9 14.21,4 12,4A8,8 0 0,0 4,12A8,8 0 0,0 12,20C15.73,20 18.84,17.45 19.73,14H17.65C16.83,16.33 14.61,18 12,18A6,6 0 0,1 6,12A6,6 0 0,1 12,6C13.66,6 15.14,6.69 16.22,7.78L13,11H20V4L17.65,6.35Z"/>
                        </svg>
                    </button>
                    <button class="status-btn" id="clear-cache" title="Очистить кэш">
                        <svg viewBox="0 0 24 24">
                            <path d="M6,19A2,2 0 0,0 8,21H16A2,2 0 0,0 18,19V7H6V19Z M8,9H16V19H8V9Z M15.5,4L14.5,3H9.5L8.5,4H5V6H19V4H15.5Z"/>
                        </svg>
                    </button>
                </div>
                <div class="status-uptime">
                    Время работы: <span id="uptime">0s</span>
                </div>
            </div>
        </div>
    </div>

    <!-- Screenshot Modal - HIDDEN TO PREVENT TEXT ISSUES -->
    <div class="modal-overlay" id="screenshot-modal" style="display: none !important; visibility: hidden !important; opacity: 0 !important; position: absolute !important; left: -9999px !important; top: -9999px !important;">
        <div class="modal screenshot-modal glass-card">
            <div class="modal-header">
                <h3 id="screenshot-modal-title">Скриншот</h3>
                <button class="close-button" id="close-screenshot-modal">
                    <svg viewBox="0 0 24 24">
                        <path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/>
                    </svg>
                </button>
            </div>
            
            <div class="screenshot-modal-content">
                <div class="screenshot-preview-large">
                    <img id="screenshot-preview-img" src="" alt="Screenshot">
                </div>
                
                <div class="screenshot-actions">
                    <button class="glass-button primary" id="download-screenshot">
                        <svg viewBox="0 0 24 24" class="button-icon">
                            <path d="M5,20H19V18H5M19,9H15V3H9V9H5L12,16L19,9Z"/>
                        </svg>
                        Скачать
                    </button>
                    <button class="glass-button secondary" id="share-screenshot">
                        <svg viewBox="0 0 24 24" class="button-icon">
                            <path d="M18,16.08C17.24,16.08 16.56,16.38 16.04,16.85L8.91,12.7C8.96,12.47 9,12.24 9,12C9,11.76 8.96,11.53 8.91,11.3L15.96,7.19C16.5,7.69 17.21,8 18,8A3,3 0 0,0 21,5A3,3 0 0,0 18,2A3,3 0 0,0 15,5C15,5.24 15.04,5.47 15.09,5.7L8.04,9.81C7.5,9.31 6.79,9 6,9A3,3 0 0,0 3,12A3,3 0 0,0 6,15C6.79,15 7.5,14.69 8.04,14.19L15.16,18.34C15.11,18.55 15.08,18.77 15.08,19C15.08,20.61 16.39,21.91 18,21.91C19.61,21.91 20.92,20.6 20.92,19A2.92,2.92 0 0,0 18,16.08Z"/>
                        </svg>
                        Поделиться
                    </button>
                    <button class="glass-button danger" id="delete-screenshot">
                        <svg viewBox="0 0 24 24" class="button-icon">
                            <path d="M6,19A2,2 0 0,0 8,21H16A2,2 0 0,0 18,19V7H6V19Z M8,9H16V19H8V9Z M15.5,4L14.5,3H9.5L8.5,4H5V6H19V4H15.5Z"/>
                        </svg>
                        Удалить
                    </button>
                </div>
                
                <div class="screenshot-info">
                    <div class="info-item">
                        <span class="info-label">Дата:</span>
                        <span id="screenshot-date">-</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">Размер:</span>
                        <span id="screenshot-size">-</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal for adding/editing players -->
    <div class="modal-overlay" id="player-modal">
        <div class="modal glass-card">
            <div class="modal-header">
                <h3 id="modal-title">Добавить игрока</h3>
                <button class="close-button" id="close-modal">
                    <svg viewBox="0 0 24 24">
                        <path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/>
                    </svg>
                </button>
            </div>
            
            <form id="player-form" class="modal-form">
                <div class="form-group">
                    <label for="player-nickname">Никнейм игрока</label>
                    <input type="text" id="player-nickname" class="glass-input" required>
                </div>
                
                <div class="form-group">
                    <label for="player-kills">Убийства</label>
                    <input type="number" id="player-kills" class="glass-input" min="0" value="0">
                </div>
                
                <div class="form-group">
                    <label for="player-deaths">Смерти</label>
                    <input type="number" id="player-deaths" class="glass-input" min="0" value="0">
                </div>
                
                <div class="form-group">
                    <label for="player-time">Время игры (часы)</label>
                    <input type="number" id="player-time" class="glass-input" min="0" step="0.1" value="0">
                </div>
                
                <div class="form-group">
                    <label for="player-screenshot">Скриншот</label>
                    <input type="file" id="player-screenshot" class="glass-input" accept="image/*">
                    <div id="screenshot-preview" class="screenshot-preview"></div>
                </div>
                
                <div class="modal-actions">
                    <button type="button" class="glass-button secondary" id="cancel-button">Отмена</button>
                    <button type="submit" class="glass-button primary">Сохранить</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Scripts -->
    <script>
        // Немедленная проверка и перенаправление если нужно
        (function() {
            // МЯГКАЯ ОЧИСТКА DOM ПРИ ЗАГРУЗКЕ - только очевидно лишние элементы
            function immediateCleanup() {
                // Убираем только явно скрытые элементы после небольшой задержки
                setTimeout(() => {
                    try {
                        // Удаляем только элементы с явным display: none, которые точно не нужны
                        document.querySelectorAll('*[style*="display: none"]:not(style):not(link):not(script)').forEach(el => {
                            if (!el.closest('.app-container') && 
                                !el.closest('head') &&
                                !el.closest('.modal-overlay') &&
                                !el.closest('#player-modal') &&
                                !el.closest('#screenshot-modal') &&
                                el.tagName !== 'SCRIPT' &&
                                el.tagName !== 'STYLE' &&
                                el.tagName !== 'LINK' &&
                                el.tagName !== 'HTML' &&
                                el.tagName !== 'BODY' &&
                                el.id !== 'titlebar-drag-region') {
                                el.remove();
                            }
                        });
                    } catch (error) {
                        // Игнорируем ошибки
                    }
                }, 100); // Очень небольшая задержка
            }
            
            immediateCleanup();
            
            // Проверяем элементы после полной загрузки DOM (БЕЗОПАСНО)
            setTimeout(() => {
                const appContainer = document.querySelector('.app-container');
                const hasScript = document.querySelector('script[src="app-optimized.js"]');
                const checkAttempted = sessionStorage.getItem('checkAttempted');
                
                // НЕ ПЕРЕНАПРАВЛЯЕМ если уже есть основные элементы
                if (appContainer && hasScript) {
                    console.log('App loaded successfully, no redirect needed');
                    return;
                }
                
                // Перенаправляем только в крайнем случае
                if (!checkAttempted && !window.location.href.includes('index.html')) {
                    sessionStorage.setItem('checkAttempted', 'true');
                    console.log('App elements not found, redirecting to index.html');
                    window.location.href = 'index.html';
                } else {
                    // Просто отмечаем, что проверка была сделана
                    sessionStorage.setItem('checkAttempted', 'true');
                }
            }, 3000); // Уменьшаем время ожидания обратно до 3 секунд
            
            // Принудительная очистка кэша и регистрация SW
            if ('serviceWorker' in navigator) {
                navigator.serviceWorker.getRegistrations().then(function(registrations) {
                    for(let registration of registrations) {
                        registration.unregister();
                    }
                    // Регистрируем заново
                    navigator.serviceWorker.register('sw.js', { scope: './' }).then(function(registration) {
                        // SW registered successfully
                    }).catch(function(error) {
                        // SW registration failed
                    });
                });
            }
        })();

        // Screenshot functionality - COMPLETELY DISABLED TO ELIMINATE ALL TEXT
        (function() {
            // МЯГКАЯ ОЧИСТКА DOM - только если приложение полностью загружено
            function gentleCleanupDOM() {
                try {
                    // Проверяем, что основное приложение работает
                    const appContainer = document.querySelector('.app-container');
                    const hasScript = document.querySelector('script[src="app-optimized.js"]');
                    
                    // НЕ ДЕЛАЕМ ОЧИСТКУ если приложение не загружено
                    if (!appContainer || !hasScript) {
                        return;
                    }
                    
                    // 1. Удаляем только элементы с явно заданным display: none (кроме critical элементов)
                    document.querySelectorAll('*[style*="display: none"]:not(style):not(link):not(script)').forEach(el => {
                        if (!el.closest('.app-container') && 
                            !el.closest('.modal-overlay') &&
                            !el.closest('#player-modal') &&
                            !el.closest('#screenshot-modal') &&
                            el.tagName !== 'STYLE' &&
                            el.tagName !== 'LINK' &&
                            el.tagName !== 'SCRIPT' &&
                            el.id !== 'persistent-background-style' &&
                            el.id !== 'titlebar-drag-region') {
                            el.remove();
                        }
                    });
                    
                    // 2. НЕ ТРОГАЕМ STYLE И LINK ЭЛЕМЕНТЫ - они критичны!
                    
                    // 3. НЕ УДАЛЯЕМ элементы по текстовому содержимому - это опасно!
                    
                } catch (error) {
                    // Игнорируем ошибки очистки
                    console.log('Gentle cleanup error ignored:', error);
                }
            }
            
            // Запускаем очистку только после полной загрузки приложения
            setTimeout(() => {
                // Проверяем, что приложение действительно загрузилось и работает
                const appContainer = document.querySelector('.app-container');
                const glasNav = document.querySelector('.glass-nav');
                const mainContent = document.querySelector('.main-content');
                const hasScript = document.querySelector('script[src="app-optimized.js"]');
                
                if (appContainer && glasNav && mainContent && hasScript) {
                    // Делаем первую мягкую очистку
                    gentleCleanupDOM();
                    
                    // Очистка каждые 30 секунд (реже чем раньше)
                    setInterval(() => {
                        // Проверяем, что приложение всё ещё работает
                        if (document.querySelector('.app-container') && 
                            document.querySelector('.glass-nav') &&
                            document.querySelector('script[src="app-optimized.js"]')) {
                            gentleCleanupDOM();
                        }
                    }, 30000); // Увеличили интервал с 10 до 30 секунд
                }
            }, 7000); // Увеличили время ожидания с 3 до 7 секунд
            
            // НЕ ДЕЛАЕМ БОЛЬШЕ НИЧЕГО СО СКРИНШОТАМИ - ПОЛНОСТЬЮ ОТКЛЮЧЕНО
            
        })();

        // System Status Monitor
        (function() {
            let statusMonitor = {
                startTime: Date.now(),
                statuses: {
                    app: 'loading',
                    dom: 'loading', 
                    scripts: 'loading',
                    background: 'waiting',
                    data: 'empty',
                    pwa: 'checking',
                    memory: 'unknown',
                    performance: 'unknown'
                },
                
                init() {
                    this.updateTime();
                    this.checkInitialStatus();
                    this.setupEventListeners();
                    this.startPeriodicChecks();
                },
                
                updateTime() {
                    const now = new Date();
                    const timeStr = now.toLocaleTimeString('ru-RU');
                    const timeEl = document.getElementById('status-time');
                    if (timeEl) timeEl.textContent = timeStr;
                    
                    // Update uptime
                    const uptime = Math.floor((Date.now() - this.startTime) / 1000);
                    const uptimeEl = document.getElementById('uptime');
                    if (uptimeEl) {
                        if (uptime < 60) {
                            uptimeEl.textContent = `${uptime}s`;
                        } else if (uptime < 3600) {
                            uptimeEl.textContent = `${Math.floor(uptime / 60)}m ${uptime % 60}s`;
                        } else {
                            const hours = Math.floor(uptime / 3600);
                            const minutes = Math.floor((uptime % 3600) / 60);
                            uptimeEl.textContent = `${hours}h ${minutes}m`;
                        }
                    }
                },
                
                checkInitialStatus() {
                    // Check DOM
                    const appContainer = document.querySelector('.app-container');
                    const glasNav = document.querySelector('.glass-nav');
                    const mainContent = document.querySelector('.main-content');
                    
                    if (appContainer && glasNav && mainContent) {
                        this.updateStatus('dom', 'success', 'Загружен');
                        this.updateStatus('app', 'success', 'Работает');
                    } else {
                        this.updateStatus('dom', 'error', 'Ошибка');
                        this.updateStatus('app', 'error', 'Не загружен');
                    }
                    
                    // Check scripts
                    const hasMainScript = document.querySelector('script[src="app-optimized.js"]');
                    if (hasMainScript) {
                        this.updateStatus('scripts', 'success', 'Загружены');
                    } else {
                        this.updateStatus('scripts', 'error', 'Отсутствуют');
                    }
                    
                    // Check PWA
                    if (window.matchMedia('(display-mode: standalone)').matches) {
                        this.updateStatus('pwa', 'success', 'Установлено');
                    } else if ('serviceWorker' in navigator) {
                        this.updateStatus('pwa', 'warning', 'Не установлено');
                    } else {
                        this.updateStatus('pwa', 'error', 'Не поддерживается');
                    }
                    
                    // Check memory
                    if (performance && performance.memory) {
                        const used = Math.round(performance.memory.usedJSHeapSize / 1024 / 1024);
                        const total = Math.round(performance.memory.totalJSHeapSize / 1024 / 1024);
                        this.updateStatus('memory', 'success', `${used}/${total}MB`);
                    } else {
                        this.updateStatus('memory', 'warning', 'Недоступно');
                    }
                    
                    // Check performance
                    if (performance && performance.now) {
                        const loadTime = Math.round(performance.now());
                        if (loadTime < 1000) {
                            this.updateStatus('performance', 'success', `${loadTime}ms`);
                        } else if (loadTime < 3000) {
                            this.updateStatus('performance', 'warning', `${loadTime}ms`);
                        } else {
                            this.updateStatus('performance', 'error', `${loadTime}ms`);
                        }
                    }
                },
                
                updateStatus(system, status, text) {
                    this.statuses[system] = status;
                    
                    const indicator = document.getElementById(`${system}-status-indicator`);
                    const textEl = document.getElementById(`${system}-status-text`);
                    
                    if (indicator) {
                        indicator.className = `status-indicator ${status}`;
                    }
                    
                    if (textEl) {
                        textEl.textContent = text;
                    }
                    
                    this.updateMainIndicator();
                },
                
                updateMainIndicator() {
                    const mainDot = document.getElementById('main-status-dot');
                    if (!mainDot) return;
                    
                    const statusValues = Object.values(this.statuses);
                    
                    if (statusValues.includes('error')) {
                        mainDot.className = 'status-dot error';
                    } else if (statusValues.includes('warning')) {
                        mainDot.className = 'status-dot warning';
                    } else if (statusValues.includes('loading')) {
                        mainDot.className = 'status-dot loading';
                    } else {
                        mainDot.className = 'status-dot';
                    }
                },
                
                setupEventListeners() {
                    const statusToggle = document.getElementById('status-toggle');
                    const statusPanel = document.getElementById('status-panel');
                    
                    if (statusToggle && statusPanel) {
                        statusToggle.addEventListener('click', () => {
                            statusPanel.classList.toggle('show');
                        });
                        
                        // Close panel when clicking outside
                        document.addEventListener('click', (e) => {
                            if (!statusToggle.contains(e.target) && !statusPanel.contains(e.target)) {
                                statusPanel.classList.remove('show');
                            }
                        });
                    }
                    
                    // Refresh button
                    const refreshBtn = document.getElementById('refresh-status');
                    if (refreshBtn) {
                        refreshBtn.addEventListener('click', () => {
                            this.checkInitialStatus();
                            this.checkDataStatus();
                            this.checkBackgroundStatus();
                        });
                    }
                    
                    // Clear cache button
                    const clearBtn = document.getElementById('clear-cache');
                    if (clearBtn) {
                        clearBtn.addEventListener('click', () => {
                            if (confirm('Очистить кэш приложения?')) {
                                localStorage.clear();
                                sessionStorage.clear();
                                location.reload();
                            }
                        });
                    }
                },
                
                checkDataStatus() {
                    try {
                        const players = JSON.parse(localStorage.getItem('players') || '[]');
                        if (players.length > 0) {
                            this.updateStatus('data', 'success', `${players.length} игроков`);
                        } else {
                            this.updateStatus('data', 'warning', 'Пусто');
                        }
                    } catch (error) {
                        this.updateStatus('data', 'error', 'Ошибка чтения');
                    }
                },
                
                checkBackgroundStatus() {
                    const bgStyle = document.documentElement.style.getPropertyValue('--current-background');
                    if (bgStyle && bgStyle.includes('url(')) {
                        this.updateStatus('background', 'success', 'Установлен');
                    } else {
                        this.updateStatus('background', 'warning', 'По умолчанию');
                    }
                },
                
                startPeriodicChecks() {
                    // Update time every second
                    setInterval(() => {
                        this.updateTime();
                    }, 1000);
                    
                    // Check status every 10 seconds
                    setInterval(() => {
                        this.checkDataStatus();
                        this.checkBackgroundStatus();
                        
                        // Update memory if available
                        if (performance && performance.memory) {
                            const used = Math.round(performance.memory.usedJSHeapSize / 1024 / 1024);
                            const total = Math.round(performance.memory.totalJSHeapSize / 1024 / 1024);
                            const percent = Math.round((used / total) * 100);
                            
                            let status = 'success';
                            if (percent > 80) status = 'error';
                            else if (percent > 60) status = 'warning';
                            
                            this.updateStatus('memory', status, `${used}/${total}MB`);
                        }
                    }, 10000);
                }
            };
            
            // Initialize status monitor when DOM is ready
            if (document.readyState === 'loading') {
                document.addEventListener('DOMContentLoaded', () => {
                    setTimeout(() => statusMonitor.init(), 1000);
                });
            } else {
                setTimeout(() => statusMonitor.init(), 1000);
            }
            
            // Make statusMonitor globally available for external updates
            window.statusMonitor = statusMonitor;
            
        })();

        // Community Chat System
        (function() {
            let communitySystem = {
                messages: [],
                username: 'Пользователь',
                isAnonymous: false,
                syncEnabled: false,
                
                init() {
                    this.loadMessages();
                    this.setupEventListeners();
                    this.updateUI();
                    this.generateUsername();
                },
                
                generateUsername() {
                    const adjectives = ['Быстрый', 'Умный', 'Сильный', 'Ловкий', 'Храбрый', 'Мудрый'];
                    const nouns = ['Игрок', 'Боец', 'Герой', 'Чемпион', 'Мастер', 'Легенда'];
                    const randomAdj = adjectives[Math.floor(Math.random() * adjectives.length)];
                    const randomNoun = nouns[Math.floor(Math.random() * nouns.length)];
                    const randomNum = Math.floor(Math.random() * 999) + 1;
                    
                    this.username = `${randomAdj}${randomNoun}${randomNum}`;
                    localStorage.setItem('communityUsername', this.username);
                },
                
                loadMessages() {
                    try {
                        const saved = localStorage.getItem('communityMessages');
                        if (saved) {
                            this.messages = JSON.parse(saved);
                        }
                        
                        const savedUsername = localStorage.getItem('communityUsername');
                        if (savedUsername) {
                            this.username = savedUsername;
                        }
                    } catch (error) {
                        console.log('Error loading community messages:', error);
                    }
                },
                
                saveMessages() {
                    try {
                        localStorage.setItem('communityMessages', JSON.stringify(this.messages));
                    } catch (error) {
                        console.log('Error saving community messages:', error);
                    }
                },
                
                setupEventListeners() {
                    const messageInput = document.getElementById('community-message-input');
                    const sendBtn = document.getElementById('send-community-message');
                    const addMessageBtn = document.getElementById('add-community-message');
                    const anonymousCheckbox = document.getElementById('anonymous-mode');
                    const syncBtn = document.getElementById('sync-community');
                    
                    // Send message on Enter or click
                    if (messageInput && sendBtn) {
                        messageInput.addEventListener('keypress', (e) => {
                            if (e.key === 'Enter' && !e.shiftKey) {
                                e.preventDefault();
                                this.sendMessage();
                            }
                        });
                        
                        messageInput.addEventListener('input', () => {
                            this.updateMessageCounter();
                        });
                        
                        sendBtn.addEventListener('click', () => {
                            this.sendMessage();
                        });
                    }
                    
                    if (addMessageBtn) {
                        addMessageBtn.addEventListener('click', () => {
                            messageInput?.focus();
                        });
                    }
                    
                    if (anonymousCheckbox) {
                        anonymousCheckbox.addEventListener('change', (e) => {
                            this.isAnonymous = e.target.checked;
                        });
                    }
                    
                    if (syncBtn) {
                        syncBtn.addEventListener('click', () => {
                            this.toggleSync();
                        });
                    }
                    
                    // Sync options
                    const syncOptions = document.querySelectorAll('.sync-option');
                    syncOptions.forEach(option => {
                        option.addEventListener('click', () => {
                            this.handleSyncOption(option.id);
                        });
                    });
                    
                    // Export/Import
                    const exportBtn = document.getElementById('export-data');
                    const importBtn = document.getElementById('import-data');
                    
                    if (exportBtn) {
                        exportBtn.addEventListener('click', () => {
                            this.exportData();
                        });
                    }
                    
                    if (importBtn) {
                        importBtn.addEventListener('click', () => {
                            this.importData();
                        });
                    }
                },
                
                sendMessage() {
                    const messageInput = document.getElementById('community-message-input');
                    if (!messageInput) return;
                    
                    const text = messageInput.value.trim();
                    if (!text || text.length > 280) return;
                    
                    const message = {
                        id: Date.now(),
                        author: this.isAnonymous ? 'Аноним' : this.username,
                        text: text,
                        time: new Date().toLocaleTimeString('ru-RU', { hour: '2-digit', minute: '2-digit' }),
                        timestamp: Date.now(),
                        isAnonymous: this.isAnonymous
                    };
                    
                    this.messages.push(message);
                    this.saveMessages();
                    this.updateUI();
                    
                    messageInput.value = '';
                    this.updateMessageCounter();
                    
                    // Show notification
                    this.showNotification('Сообщение отправлено!');
                },
                
                updateMessageCounter() {
                    const messageInput = document.getElementById('community-message-input');
                    const counter = document.getElementById('message-counter');
                    
                    if (!messageInput || !counter) return;
                    
                    const length = messageInput.value.length;
                    counter.textContent = `${length}/280`;
                    
                    counter.className = 'message-counter';
                    if (length > 250) {
                        counter.classList.add('warning');
                    }
                    if (length > 280) {
                        counter.classList.add('error');
                    }
                    
                    const sendBtn = document.getElementById('send-community-message');
                    if (sendBtn) {
                        sendBtn.disabled = length === 0 || length > 280;
                    }
                },
                
                updateUI() {
                    this.renderMessages();
                    this.updateCommunityStatus();
                },
                
                renderMessages() {
                    const container = document.getElementById('community-messages');
                    if (!container) return;
                    
                    // Keep system messages, add user messages
                    const systemMessages = container.querySelectorAll('.system-message');
                    container.innerHTML = '';
                    
                    // Re-add system messages
                    systemMessages.forEach(msg => container.appendChild(msg));
                    
                    // Add user messages
                    this.messages.slice(-10).forEach(message => {
                        const messageEl = this.createMessageElement(message);
                        container.appendChild(messageEl);
                    });
                    
                    // Scroll to bottom
                    container.scrollTop = container.scrollHeight;
                },
                
                createMessageElement(message) {
                    const messageEl = document.createElement('div');
                    messageEl.className = 'message-item';
                    
                    const avatar = message.isAnonymous ? '🕶️' : '👤';
                    
                    messageEl.innerHTML = `
                        <div class="message-avatar">${avatar}</div>
                        <div class="message-content">
                            <div class="message-header">
                                <span class="message-author">${message.author}</span>
                                <span class="message-time">${message.time}</span>
                            </div>
                            <div class="message-text">${this.escapeHtml(message.text)}</div>
                        </div>
                    `;
                    
                    return messageEl;
                },
                
                updateCommunityStatus() {
                    const statusDot = document.getElementById('community-status-dot');
                    const statusText = document.getElementById('community-status-text');
                    const usersCount = document.getElementById('community-users');
                    
                    if (statusDot) {
                        statusDot.className = 'status-indicator';
                        if (this.syncEnabled) {
                            statusDot.classList.add('online');
                        }
                    }
                    
                    if (statusText) {
                        statusText.textContent = this.syncEnabled ? 'Онлайн' : 'Локальный режим';
                    }
                    
                    if (usersCount) {
                        const count = this.syncEnabled ? Math.floor(Math.random() * 5) + 2 : 1;
                        usersCount.textContent = `${count} ${count === 1 ? 'пользователь' : 'пользователей'}`;
                    }
                },
                
                toggleSync() {
                    this.syncEnabled = !this.syncEnabled;
                    this.updateUI();
                    
                    if (this.syncEnabled) {
                        this.showNotification('Синхронизация включена! (демо-режим)');
                        // Simulate receiving a message
                        setTimeout(() => {
                            this.simulateIncomingMessage();
                        }, 3000);
                    } else {
                        this.showNotification('Переключен в локальный режим');
                    }
                },
                
                simulateIncomingMessage() {
                    if (!this.syncEnabled) return;
                    
                    const demoMessages = [
                        'Привет всем! 👋',
                        'Как дела с игрой?',
                        'Кто-нибудь играл сегодня?',
                        'Отличная статистика!',
                        'Хорошая игра вчера 🎮'
                    ];
                    
                    const demoUsers = ['ПроИгрок123', 'ГеймерПро', 'СкиллМастер', 'ЛегендаИгр'];
                    
                    const message = {
                        id: Date.now(),
                        author: demoUsers[Math.floor(Math.random() * demoUsers.length)],
                        text: demoMessages[Math.floor(Math.random() * demoMessages.length)],
                        time: new Date().toLocaleTimeString('ru-RU', { hour: '2-digit', minute: '2-digit' }),
                        timestamp: Date.now(),
                        isAnonymous: false,
                        isDemo: true
                    };
                    
                    this.messages.push(message);
                    this.updateUI();
                    this.showNotification(`Новое сообщение от ${message.author}`);
                },
                
                handleSyncOption(optionId) {
                    switch(optionId) {
                        case 'github-sync-option':
                            this.showNotification('GitHub Gists синхронизация (в разработке)');
                            break;
                        case 'firebase-sync-option':
                            this.showNotification('Firebase синхронизация (в разработке)');
                            break;
                        case 'qr-sync-option':
                            this.generateQRCode();
                            break;
                    }
                },
                
                generateQRCode() {
                    const data = {
                        players: JSON.parse(localStorage.getItem('players') || '[]'),
                        messages: this.messages.slice(-5),
                        exported: new Date().toISOString()
                    };
                    
                    const qrData = btoa(JSON.stringify(data));
                    this.showNotification(`QR-код готов! Данные: ${qrData.length} символов`);
                },
                
                exportData() {
                    const data = {
                        players: JSON.parse(localStorage.getItem('players') || '[]'),
                        messages: this.messages,
                        settings: {
                            username: this.username,
                            syncEnabled: this.syncEnabled
                        },
                        exported: new Date().toISOString()
                    };
                    
                    const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
                    const url = URL.createObjectURL(blob);
                    const a = document.createElement('a');
                    a.href = url;
                    a.download = `community-backup-${new Date().toISOString().split('T')[0]}.json`;
                    a.click();
                    URL.revokeObjectURL(url);
                    
                    this.showNotification('Данные экспортированы!');
                },
                
                importData() {
                    const input = document.createElement('input');
                    input.type = 'file';
                    input.accept = '.json';
                    input.onchange = (e) => {
                        const file = e.target.files[0];
                        if (!file) return;
                        
                        const reader = new FileReader();
                        reader.onload = (e) => {
                            try {
                                const data = JSON.parse(e.target.result);
                                
                                if (data.players) {
                                    localStorage.setItem('players', JSON.stringify(data.players));
                                }
                                if (data.messages) {
                                    this.messages = data.messages;
                                    this.saveMessages();
                                }
                                if (data.settings) {
                                    this.username = data.settings.username || this.username;
                                    localStorage.setItem('communityUsername', this.username);
                                }
                                
                                this.updateUI();
                                this.showNotification('Данные импортированы!');
                                
                                // Refresh the page to update all data
                                setTimeout(() => {
                                    location.reload();
                                }, 1000);
                                
                            } catch (error) {
                                this.showNotification('Ошибка при импорте данных!');
                            }
                        };
                        reader.readAsText(file);
                    };
                    input.click();
                },
                
                showNotification(message) {
                    // Create a simple notification
                    const notification = document.createElement('div');
                    notification.style.cssText = `
                        position: fixed;
                        top: 20px;
                        right: 20px;
                        background: var(--glass-bg);
                        color: var(--text-primary);
                        padding: 12px 20px;
                        border-radius: 8px;
                        border: 1px solid var(--glass-border);
                        backdrop-filter: var(--backdrop-filter);
                        box-shadow: var(--glass-shadow);
                        z-index: 10000;
                        font-size: 14px;
                        max-width: 300px;
                        opacity: 0;
                        transform: translateX(100%);
                        transition: all 0.3s ease;
                    `;
                    notification.textContent = message;
                    document.body.appendChild(notification);
                    
                    // Animate in
                    setTimeout(() => {
                        notification.style.opacity = '1';
                        notification.style.transform = 'translateX(0)';
                    }, 100);
                    
                    // Remove after 3 seconds
                    setTimeout(() => {
                        notification.style.opacity = '0';
                        notification.style.transform = 'translateX(100%)';
                        setTimeout(() => {
                            if (notification.parentNode) {
                                notification.parentNode.removeChild(notification);
                            }
                        }, 300);
                    }, 3000);
                },
                
                escapeHtml(text) {
                    const div = document.createElement('div');
                    div.textContent = text;
                    return div.innerHTML;
                }
            };
            
            // Initialize community system when DOM is ready
            if (document.readyState === 'loading') {
                document.addEventListener('DOMContentLoaded', () => {
                    setTimeout(() => communitySystem.init(), 1500);
                });
            } else {
                setTimeout(() => communitySystem.init(), 1500);
            }
            
            // Make community system globally available
            window.communitySystem = communitySystem;
            
        })();
    </script>
    
    <!-- Простой JavaScript для чата -->
    <script>
        function sendSimpleMessage() {
            const input = document.getElementById('simple-chat-input');
            const messagesContainer = document.getElementById('simple-messages');
            
            if (input && input.value.trim()) {
                const messageText = input.value.trim();
                const now = new Date();
                const time = now.getHours().toString().padStart(2, '0') + ':' + 
                           now.getMinutes().toString().padStart(2, '0');
                
                // Создаём новое сообщение
                const messageDiv = document.createElement('div');
                messageDiv.style.cssText = 'color: #ccc; margin-bottom: 15px; padding: 10px; background: rgba(255,255,255,0.1); border-radius: 6px;';
                messageDiv.innerHTML = '<strong style="color: #4CAF50;">🎮 Вы:</strong> ' + 
                                      messageText + 
                                      ' <span style="color: #999; font-size: 11px; float: right;">' + time + '</span>';
                
                // Добавляем сообщение в контейнер
                messagesContainer.appendChild(messageDiv);
                
                // Очищаем поле ввода
                input.value = '';
                
                // Прокручиваем к последнему сообщению
                messagesContainer.scrollTop = messagesContainer.scrollHeight;
                
                // Симуляция ответа через 1-3 секунды
                setTimeout(() => {
                    const responses = [
                        '👍 Согласен!',
                        '🔥 Круто получилось!', 
                        '⚡ Давайте играть!',
                        '🎯 Хорошая идея!',
                        '💪 Я за!',
                        '🚀 Поехали!',
                        '🏆 Отличный план!',
                        '✨ Супер!'
                    ];
                    
                    const names = ['ПроГеймер', 'БыстрыйСтрелок', 'ЛегендаИгр', 'УмныйБоец'];
                    const colors = ['#2196F3', '#FF9800', '#9C27B0', '#F44336'];
                    
                    const randomResponse = responses[Math.floor(Math.random() * responses.length)];
                    const randomName = names[Math.floor(Math.random() * names.length)];
                    const randomColor = colors[Math.floor(Math.random() * colors.length)];
                    
                    const responseDiv = document.createElement('div');
                    responseDiv.style.cssText = 'color: #ccc; margin-bottom: 15px; padding: 10px; background: rgba(255,255,255,0.05); border-radius: 6px;';
                    
                    const responseTime = new Date();
                    const responseTimeStr = responseTime.getHours().toString().padStart(2, '0') + ':' + 
                                          responseTime.getMinutes().toString().padStart(2, '0');
                    
                    responseDiv.innerHTML = '<strong style="color: ' + randomColor + ';">🎮 ' + randomName + ':</strong> ' + 
                                          randomResponse + 
                                          ' <span style="color: #999; font-size: 11px; float: right;">' + responseTimeStr + '</span>';
                    
                    messagesContainer.appendChild(responseDiv);
                    messagesContainer.scrollTop = messagesContainer.scrollHeight;
                }, Math.random() * 2000 + 1000);
            }
        }
        
        // Отправка по Enter
        document.addEventListener('DOMContentLoaded', function() {
            const input = document.getElementById('simple-chat-input');
            if (input) {
                input.addEventListener('keypress', function(e) {
                    if (e.key === 'Enter') {
                        sendSimpleMessage();
                    }
                });
            }
        });
    </script>
    
    <script src="app-optimized.js"></script>
</body>
</html>
